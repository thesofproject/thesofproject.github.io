<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="512px" preserveAspectRatio="none" style="width:719px;height:512px;" version="1.1" viewBox="0 0 719 512" width="719px" zoomAndPan="magnify"><defs><filter height="300%" id="f1lmeo82oajdae" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="57.3516" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="41" y="395.1641"/><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="63.3516" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="299" y="142.5703"/><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="204.7578" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="299" y="278.1094"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="46" x2="46" y1="105.2188" y2="213.9219"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="46" x2="46" y1="213.9219" y2="255.7578"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="46" x2="46" y1="255.7578" y2="500.8672"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="303.5" x2="303.5" y1="105.2188" y2="213.9219"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="303.5" x2="303.5" y1="213.9219" y2="255.7578"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="303.5" x2="303.5" y1="255.7578" y2="500.8672"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="664.5" x2="664.5" y1="105.2188" y2="213.9219"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="664.5" x2="664.5" y1="213.9219" y2="255.7578"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="664.5" x2="664.5" y1="255.7578" y2="500.8672"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="19" x="33.5" y="84.5332">dai</text><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="8" y="102.1426">component</text><ellipse cx="46" cy="13" fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" rx="8" ry="8" style="stroke: #33335B; stroke-width: 2.0;"/><path d="M46,21 L46,48 M33,29 L59,29 M46,48 L33,63 M46,48 L59,63 " fill="none" filter="url(#f1lmeo82oajdae)" style="stroke: #33335B; stroke-width: 2.0;"/><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="73" x="265.5" y="68.6094"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="272.5" y="90.1426">hda_dma</text><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="91" x="617.5" y="68.6094"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="624.5" y="90.1426">work_queue</text><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="57.3516" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="41" y="395.1641"/><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="63.3516" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="299" y="142.5703"/><rect fill="#FFFFFF" filter="url(#f1lmeo82oajdae)" height="204.7578" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="299" y="278.1094"/><polygon fill="#4A4A86" points="287,138.5703,297,142.5703,287,146.5703,291,142.5703" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="46" x2="293" y1="142.5703" y2="142.5703"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="53" y="137.7139">dma_start()</text><path d="M314,120.2188 L314,146.2188 L490,146.2188 L490,130.2188 L480,120.2188 L314,120.2188 " fill="#F6ED80" filter="url(#f1lmeo82oajdae)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M480,120.2188 L480,130.2188 L490,130.2188 L480,120.2188 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="320" y="138.7139">GEN := 1 -&gt; transfer starts</text><polygon fill="#4A4A86" points="653,173.9219,663,177.9219,653,181.9219,657,177.9219" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="309" x2="659" y1="177.9219" y2="177.9219"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="332" x="316" y="173.0654">work_schedule_default(&amp;hda_work, HDA_LINK_1MS_US)</text><polygon fill="#4A4A86" points="320,187.9219,310,191.9219,320,195.9219,316,191.9219" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="314" x2="664" y1="191.9219" y2="191.9219"/><polygon fill="#4A4A86" points="57,201.9219,47,205.9219,57,209.9219,53,205.9219" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="51" x2="303" y1="205.9219" y2="205.9219"/><text fill="#33335B" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="323.5" y="239.3408">1 ms elapsed</text><polygon fill="#4A4A86" points="320,274.1094,310,278.1094,320,282.1094,316,278.1094" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="314" x2="664" y1="278.1094" y2="278.1094"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="326" y="273.2529">hda_work-&gt;cb()</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="309" x2="351" y1="308.4609" y2="308.4609"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="351" x2="351" y1="308.4609" y2="321.4609"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="310" x2="351" y1="321.4609" y2="321.4609"/><polygon fill="#4A4A86" points="320,317.4609,310,321.4609,320,325.4609,316,321.4609" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="316" y="303.6045">update FPI by 'bytes'</text><path d="M449,292.6094 L449,318.6094 L693,318.6094 L693,302.6094 L683,292.6094 L449,292.6094 " fill="#F6ED80" filter="url(#f1lmeo82oajdae)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M683,292.6094 L683,302.6094 L693,302.6094 L683,292.6094 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="455" y="311.1045">'commit' is always true in this scenario</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="309" x2="351" y1="351.8125" y2="351.8125"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="351" x2="351" y1="351.8125" y2="364.8125"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="310" x2="351" y1="364.8125" y2="364.8125"/><polygon fill="#4A4A86" points="320,360.8125,310,364.8125,320,368.8125,316,364.8125" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="316" y="346.9561">wait for next period to be available (w/ short t/o)</text><polygon fill="#4A4A86" points="62,391.1641,52,395.1641,62,399.1641,58,395.1641" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="56" x2="298" y1="395.1641" y2="395.1641"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="68" y="390.3076">callback()</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="51" x2="93" y1="425.5156" y2="425.5156"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="93" x2="93" y1="425.5156" y2="438.5156"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="52" x2="93" y1="438.5156" y2="438.5156"/><polygon fill="#4A4A86" points="62,434.5156,52,438.5156,62,442.5156,58,438.5156" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="58" y="420.6592">comp_update_buffer_produce/consume()</text><polygon fill="#4A4A86" points="287,448.5156,297,452.5156,287,456.5156,291,452.5156" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="46" x2="293" y1="452.5156" y2="452.5156"/><polygon fill="#4A4A86" points="653,478.8672,663,482.8672,653,486.8672,657,482.8672" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="304" x2="659" y1="482.8672" y2="482.8672"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="209" x="311" y="478.0107">1MS_TIMEOUT (to re-arm the timer)</text><!--MD5=[27583e49defda83f76d9b93078fe89b5]
@startuml
hidefootbox
skinparam componentStyle uml2

skinparam defaultFontColor	#33335b

skinparam rectangle {
	color		#d6d6de
	backgroundColor	#ffffff
}

skinparam component {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}

skinparam interface {
	backgroundColor	#ffffff
	borderColor	#f05772
}

skinparam class {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}
skinparam stereotypeCBackgroundColor	#6fccdd

skinparam sequence {
	arrowColor		#4a4a86
	lifeLineBorderColor	#f05772
	groupBorderColor	#a1a1ca
	boxBorderColor		#a1a1ca
	dividerBorderColor	#d6d6de
	dividerBorderThickness	1
}
skinparam participant {
	borderColor		#33335b
	backgroundColor		#ffffff
}
skinparam actor {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam state {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam node {
	backgroundColor		#ffffff
}

skinparam note {
	backgroundColor 	#f6ed80
	borderColor		#d6d6de
}
actor client as "dai\ncomponent"
participant hda_dma
participant work_queue

client -> hda_dma : dma_start()
	activate hda_dma
	note right: GEN := 1 -> transfer starts

	hda_dma -> work_queue : work_schedule_default(&hda_work, HDA_LINK_1MS_US)
	hda_dma <- - work_queue
client <- - hda_dma
deactivate hda_dma

... 1 ms elapsed ...

work_queue -> hda_dma : hda_work->cb()
	activate hda_dma

   hda_dma -> hda_dma : update FPI by 'bytes'
   note right: 'commit' is always true in this scenario

	hda_dma -> hda_dma : wait for next period to be available (w/ short t/o)

	hda_dma -> client : callback()
		activate client
		client -> client : comp_update_buffer_produce/consume()
	hda_dma <- - client
	deactivate client

work_queue <- - hda_dma : 1MS_TIMEOUT (to re-arm the timer)
deactivate hda_dma

@enduml

PlantUML version 1.2019.12(Sun Nov 03 11:24:54 CET 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_302-b08
Operating System: Windows 10
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>