<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="737px" preserveAspectRatio="none" style="width:1011px;height:737px;" version="1.1" viewBox="0 0 1011 737" width="1011px" zoomAndPan="magnify"><defs><filter height="300%" id="f11xs5f03l71u1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#ADD8E6" height="715.0859" style="stroke: #A1A1CA; stroke-width: 1.0;" width="860" x="8" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="103" x="386.5" y="16.0669">SOF Firmware</text><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="134.5313" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="79" y="443.0234"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="114.3984" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="278" y="175.9609"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="58.2656" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="278" y="519.2891"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="647.6563" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="490" y="68.4297"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="256.9297" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="799" y="104.6953"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="14" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="804" y="205.0938"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="200.7969" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="799" y="405.8906"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="56.1328" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="799" y="650.9531"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="84" x2="84" y1="58.4297" y2="725.0859"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="282.5" x2="282.5" y1="58.4297" y2="725.0859"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="494.5" x2="494.5" y1="58.4297" y2="725.0859"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="804" x2="804" y1="58.4297" y2="725.0859"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="140" x="12" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="126" x="19" y="43.1279">Firmware Manager</text><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="125" x="218.5" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="225.5" y="43.1279">MPP Scheduling</text><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="137" x="424.5" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="431.5" y="43.1279">Zephyr Scheduler</text><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="116" x="744" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="102" x="751" y="43.1279">Zephyr Thread</text><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="134.5313" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="79" y="443.0234"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="114.3984" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="278" y="175.9609"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="58.2656" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="278" y="519.2891"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="647.6563" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="490" y="68.4297"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="256.9297" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="799" y="104.6953"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="14" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="804" y="205.0938"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="200.7969" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="799" y="405.8906"/><rect fill="#FFFFFF" filter="url(#f11xs5f03l71u1)" height="56.1328" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="799" y="650.9531"/><polygon fill="#F05772" points="787,100.6953,797,104.6953,787,108.6953,791,104.6953" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="500" x2="793" y1="104.6953" y2="104.6953"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="507" y="84.4966">schedule IPC Task with Budget (TWB) thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="507" y="99.6294">(MEDIUM_PRIO)</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="809" x2="851" y1="133.8281" y2="133.8281"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="851" x2="851" y1="133.8281" y2="146.8281"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="810" x2="851" y1="146.8281" y2="146.8281"/><polygon fill="#F05772" points="820,142.8281,810,146.8281,820,150.8281,816,146.8281" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="816" y="128.7622">run</text><polygon fill="#F05772" points="299,171.9609,289,175.9609,299,179.9609,295,175.9609" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="293" x2="798" y1="175.9609" y2="175.9609"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="305" y="170.895">on processing complete</text><polygon fill="#F05772" points="792,201.0938,802,205.0938,792,209.0938,796,205.0938" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="288" x2="798" y1="205.0938" y2="205.0938"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="295" y="200.0278">k_thread_runtime_stats_get</text><polygon fill="#F05772" points="299,215.0938,289,219.0938,299,223.0938,295,219.0938" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="293" x2="798" y1="219.0938" y2="219.0938"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="288" x2="330" y1="263.3594" y2="263.3594"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="330" x2="330" y1="263.3594" y2="276.3594"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="289" x2="330" y1="276.3594" y2="276.3594"/><polygon fill="#F05772" points="299,272.3594,289,276.3594,299,280.3594,295,276.3594" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="295" y="243.1606">update IPC Task with budget</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="295" y="258.2935">cycles_consumed_in_sys_tick</text><polygon fill="#F05772" points="787,286.3594,797,290.3594,787,294.3594,791,290.3594" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="283" x2="793" y1="290.3594" y2="290.3594"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="809" x2="851" y1="334.625" y2="334.625"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="851" x2="851" y1="334.625" y2="347.625"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="810" x2="851" y1="347.625" y2="347.625"/><polygon fill="#F05772" points="820,343.625,810,347.625,820,351.625,816,347.625" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="816" y="314.4263">suspend TWB Zephyr Thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="816" y="329.5591">(k_sem_take)</text><polygon fill="#F05772" points="511,357.625,501,361.625,511,365.625,507,361.625" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="505" x2="803" y1="361.625" y2="361.625"/><polygon fill="#F05772" points="787,401.8906,797,405.8906,787,409.8906,791,405.8906" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="500" x2="793" y1="405.8906" y2="405.8906"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="507" y="385.6919">schedule EDF thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="507" y="400.8247">(LOW_PRIO)</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="809" x2="856" y1="430.0234" y2="430.0234"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="856" x2="856" y1="430.0234" y2="443.0234"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="815" x2="856" y1="443.0234" y2="443.0234"/><polygon fill="#F05772" points="825,439.0234,815,443.0234,825,447.0234,821,443.0234" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="821" y="424.9575">run</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="89" x2="131" y1="477.1563" y2="477.1563"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="131" x2="131" y1="477.1563" y2="490.1563"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="90" x2="131" y1="490.1563" y2="490.1563"/><polygon fill="#F05772" points="100,486.1563,90,490.1563,100,494.1563,96,490.1563" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="96" y="472.0903">Host IPC message received</text><polygon fill="#F05772" points="266,515.2891,276,519.2891,266,523.2891,270,519.2891" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="89" x2="272" y1="519.2891" y2="519.2891"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="96" y="514.2231">request IPC processing</text><polygon fill="#F05772" points="787,559.5547,797,563.5547,787,567.5547,791,563.5547" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="288" x2="793" y1="563.5547" y2="563.5547"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="295" y="543.356">resume IPC TWB Zephyr Thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="295" y="558.4888">(k_sem_give)</text><polygon fill="#F05772" points="95,573.5547,85,577.5547,95,581.5547,91,577.5547" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="89" x2="282" y1="577.5547" y2="577.5547"/><polygon fill="#F05772" points="511,602.6875,501,606.6875,511,610.6875,507,606.6875" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="505" x2="803" y1="606.6875" y2="606.6875"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="517" y="601.6216">EDF thread gets preempted</text><polygon fill="#F05772" points="787,646.9531,797,650.9531,787,654.9531,791,650.9531" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="500" x2="793" y1="650.9531" y2="650.9531"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="507" y="630.7544">schedule IPC task with budget thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="507" y="645.8872">(MEDIUM_PRIO)</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="809" x2="851" y1="680.0859" y2="680.0859"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="851" x2="851" y1="680.0859" y2="693.0859"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="810" x2="851" y1="693.0859" y2="693.0859"/><polygon fill="#F05772" points="820,689.0859,810,693.0859,820,697.0859,816,693.0859" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="816" y="675.02">run</text><polygon fill="#F05772" points="511,703.0859,501,707.0859,511,711.0859,507,707.0859" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="505" x2="803" y1="707.0859" y2="707.0859"/><!--MD5=[279481cc53dfc5578a2b2152c0b6c222]
@startuml
hidefootbox
skinparam componentStyle uml2

skinparam defaultFontColor	#33335b

skinparam rectangle {
	color		#d6d6de
	backgroundColor	#ffffff
}

skinparam component {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}

skinparam interface {
	backgroundColor	#ffffff
	borderColor	#f05772
}

skinparam class {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}
skinparam stereotypeCBackgroundColor	#6fccdd

skinparam sequence {
	arrowColor		#4a4a86
	lifeLineBorderColor	#f05772
	groupBorderColor	#a1a1ca
	boxBorderColor		#a1a1ca
	dividerBorderColor	#d6d6de
	dividerBorderThickness	1
}
skinparam participant {
	borderColor		#33335b
	backgroundColor		#ffffff
}
skinparam actor {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam state {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam node {
	backgroundColor		#ffffff
}

skinparam note {
	backgroundColor 	#f6ed80
	borderColor		#d6d6de
}

skinparam activity {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam activityDiamond {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam arrowColor	#f05772
skinparam maxMessageSize 400
skinparam BoxPadding 4

skinparam maxMessageSize 400
skinparam BoxPadding 4

box "SOF Firmware" #LightBlue
	participant "Firmware Manager"
	participant "MPP Scheduling"
	participant "Zephyr Scheduler"
	participant "Zephyr Thread"
end box

activate "Zephyr Scheduler"

"Zephyr Scheduler"-> "Zephyr Thread": schedule IPC Task with Budget (TWB) thread\n(MEDIUM_PRIO)
activate "Zephyr Thread"

	"Zephyr Thread"-> "Zephyr Thread": run
	"Zephyr Thread"-> "MPP Scheduling": on processing complete
	activate "MPP Scheduling"
		"MPP Scheduling"-> "Zephyr Thread": k_thread_runtime_stats_get
		activate "Zephyr Thread"
		return
		"MPP Scheduling"-> "MPP Scheduling": update IPC Task with budget\ncycles_consumed_in_sys_tick
	return
	"Zephyr Thread"-> "Zephyr Thread": suspend TWB Zephyr Thread\n(k_sem_take)
return

"Zephyr Scheduler"-> "Zephyr Thread": schedule EDF thread\n(LOW_PRIO)
activate "Zephyr Thread"
	"Zephyr Thread"-> "Zephyr Thread": run

	activate "Firmware Manager"
	"Firmware Manager"-> "Firmware Manager": Host IPC message received
		"Firmware Manager"-> "MPP Scheduling": request IPC processing
		activate "MPP Scheduling"
		"MPP Scheduling"-> "Zephyr Thread": resume IPC TWB Zephyr Thread\n(k_sem_give)
		"MPP Scheduling" - -> "Firmware Manager"
		deactivate "MPP Scheduling"
	deactivate "Firmware Manager"

"Zephyr Thread" - -> "Zephyr Scheduler": EDF thread gets preempted
deactivate "Zephyr Thread"

"Zephyr Scheduler"-> "Zephyr Thread": schedule IPC task with budget thread\n(MEDIUM_PRIO)
	activate "Zephyr Thread"
		"Zephyr Thread"-> "Zephyr Thread": run
	return

@enduml

PlantUML version 1.2019.12(Sun Nov 03 10:24:54 UTC 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.22+7
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>