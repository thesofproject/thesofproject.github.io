<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1463px" preserveAspectRatio="none" style="width:1237px;height:1463px;" version="1.1" viewBox="0 0 1237 1463" width="1237px" zoomAndPan="magnify"><defs><filter height="300%" id="f37zls9jw0b9j" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#ADD8E6" height="1441.4766" style="stroke: #A1A1CA; stroke-width: 1.0;" width="1079" x="29" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="554" y="16.0669">SOF</text><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="176.9297" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="92.5" y="89.5625"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="98.5313" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="92.5" y="819.8828"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="201.9297" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="92.5" y="962.3516"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="1284.5156" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="513.5" y="157.9609"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="360.4609" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="865.5" y="266.4922"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="231.4297" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="870.5" y="317.2578"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="540.1953" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="865.5" y="695.3516"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="44.2656" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="870.5" y="991.4844"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="95.9648" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="865.5" y="1330.5117"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="61.3984" style="stroke: #A1A1CA; stroke-width: 2.0;" width="576" x="23" y="104.5625"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="105.5313" style="stroke: #A1A1CA; stroke-width: 2.0;" width="311" x="790.5" y="350.8906"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="74.3984" style="stroke: #A1A1CA; stroke-width: 2.0;" width="291" x="800.5" y="375.0234"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="59.2656" style="stroke: #A1A1CA; stroke-width: 2.0;" width="276" x="800.5" y="470.4219"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="608.5938" style="stroke: #A1A1CA; stroke-width: 2.0;" width="1079.5" x="13" y="641.9531"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="491.0625" style="stroke: #A1A1CA; stroke-width: 2.0;" width="1059.5" x="23" y="752.4844"/><rect fill="#FFFFFF" height="317.1328" style="stroke: none; stroke-width: 1.0;" width="1059.5" x="23" y="926.4141"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="169.9297" style="stroke: #A1A1CA; stroke-width: 2.0;" width="788.5" x="438" y="1264.5469"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="97" x2="97" y1="58.4297" y2="1451.4766"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="518" x2="518" y1="58.4297" y2="1451.4766"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="870.5" x2="870.5" y1="58.4297" y2="1451.4766"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1075" x2="1075" y1="58.4297" y2="1451.4766"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="125" x="33" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="40" y="43.1279">MPP Scheduling</text><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="137" x="448" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="455" y="43.1279">Zephyr Scheduler</text><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="116" x="810.5" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="102" x="817.5" y="43.1279">Zephyr Thread</text><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="53" x="1047" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="1054" y="43.1279">Timer</text><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="176.9297" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="92.5" y="89.5625"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="98.5313" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="92.5" y="819.8828"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="201.9297" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="92.5" y="962.3516"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="1284.5156" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="513.5" y="157.9609"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="360.4609" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="865.5" y="266.4922"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="231.4297" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="870.5" y="317.2578"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="540.1953" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="865.5" y="695.3516"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="44.2656" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="870.5" y="991.4844"/><rect fill="#FFFFFF" filter="url(#f37zls9jw0b9j)" height="95.9648" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="865.5" y="1330.5117"/><polygon fill="#F05772" points="113.5,85.5625,103.5,89.5625,113.5,93.5625,109.5,89.5625" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="107.5" x2="1074.5" y1="89.5625" y2="89.5625"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="119.5" y="84.4966">sys_tick callback</text><path d="M23,104.5625 L100,104.5625 L100,111.5625 L90,121.5625 L23,121.5625 L23,104.5625 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="61.3984" style="stroke: #A1A1CA; stroke-width: 2.0;" width="576" x="23" y="104.5625"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="38" y="117.6294">loop</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="115" y="116.7729">[for each core]</text><polygon fill="#F05772" points="501.5,153.9609,511.5,157.9609,501.5,161.9609,505.5,157.9609" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="102.5" x2="507.5" y1="157.9609" y2="157.9609"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="109.5" y="137.7622">resume LL Zephyr Thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="109.5" y="152.895">(k_sem_give)</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="102.5" x2="144.5" y1="209.2266" y2="209.2266"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="144.5" x2="144.5" y1="209.2266" y2="222.2266"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="103.5" x2="144.5" y1="222.2266" y2="222.2266"/><polygon fill="#F05772" points="113.5,218.2266,103.5,222.2266,113.5,226.2266,109.5,222.2266" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="109.5" y="189.0278">DP and Task with Budget</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="109.5" y="204.1606">Zephyr Threads update</text><polygon fill="#F05772" points="853.5,262.4922,863.5,266.4922,853.5,270.4922,857.5,266.4922" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="523.5" x2="859.5" y1="266.4922" y2="266.4922"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="530.5" y="246.2935">schedule LL Zephyr Thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="530.5" y="261.4263">(context switch)</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="875.5" x2="922.5" y1="304.2578" y2="304.2578"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="922.5" x2="922.5" y1="304.2578" y2="317.2578"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="881.5" x2="922.5" y1="317.2578" y2="317.2578"/><polygon fill="#F05772" points="891.5,313.2578,881.5,317.2578,891.5,321.2578,887.5,317.2578" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="887.5" y="299.1919">zephyr_ll_run</text><path d="M562,279.4922 L562,334.4922 L856,334.4922 L856,289.4922 L846,279.4922 L562,279.4922 " fill="#F6ED80" filter="url(#f37zls9jw0b9j)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M846,279.4922 L846,289.4922 L856,289.4922 L846,279.4922 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="273" x="568" y="296.5591">LL pending tasks are scheduled operations</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="265" x="568" y="311.6919">that are waiting for certain circumstances</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="568" y="326.8247">(like data arrival) to start processing</text><path d="M790.5,350.8906 L867.5,350.8906 L867.5,357.8906 L857.5,367.8906 L790.5,367.8906 L790.5,350.8906 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="105.5313" style="stroke: #A1A1CA; stroke-width: 2.0;" width="311" x="790.5" y="350.8906"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="805.5" y="363.9575">loop</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="882.5" y="363.1011">[for each LL pending task]</text><path d="M800.5,375.0234 L870.5,375.0234 L870.5,382.0234 L860.5,392.0234 L800.5,392.0234 L800.5,375.0234 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="74.3984" style="stroke: #A1A1CA; stroke-width: 2.0;" width="291" x="800.5" y="375.0234"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="815.5" y="388.0903">opt</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="201" x="885.5" y="387.2339">[if task is ready for processing]</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="880.5" x2="922.5" y1="428.4219" y2="428.4219"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="922.5" x2="922.5" y1="428.4219" y2="441.4219"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="881.5" x2="922.5" y1="441.4219" y2="441.4219"/><polygon fill="#F05772" points="891.5,437.4219,881.5,441.4219,891.5,445.4219,887.5,441.4219" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="887.5" y="408.2231">move task</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="887.5" y="423.356">to LL run queue</text><path d="M800.5,470.4219 L877.5,470.4219 L877.5,477.4219 L867.5,487.4219 L800.5,487.4219 L800.5,470.4219 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="59.2656" style="stroke: #A1A1CA; stroke-width: 2.0;" width="276" x="800.5" y="470.4219"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="815.5" y="483.4888">loop</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="179" x="892.5" y="482.6323">[for each task in LL queues]</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="880.5" x2="922.5" y1="508.6875" y2="508.6875"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="922.5" x2="922.5" y1="508.6875" y2="521.6875"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="881.5" x2="922.5" y1="521.6875" y2="521.6875"/><polygon fill="#F05772" points="891.5,517.6875,881.5,521.6875,891.5,525.6875,887.5,521.6875" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="887.5" y="503.6216">run LL task callback</text><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="880.5" x2="922.5" y1="547.6875" y2="547.6875"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="922.5" x2="922.5" y1="547.6875" y2="560.6875"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="875.5" x2="922.5" y1="560.6875" y2="560.6875"/><polygon fill="#F05772" points="885.5,556.6875,875.5,560.6875,885.5,564.6875,881.5,560.6875" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="875.5" x2="917.5" y1="599.9531" y2="599.9531"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="917.5" x2="917.5" y1="599.9531" y2="612.9531"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="876.5" x2="917.5" y1="612.9531" y2="612.9531"/><polygon fill="#F05772" points="886.5,608.9531,876.5,612.9531,886.5,616.9531,882.5,612.9531" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="882.5" y="579.7544">suspend LL Zephyr Thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="882.5" y="594.8872">(k_sem_take)</text><polygon fill="#F05772" points="534.5,622.9531,524.5,626.9531,534.5,630.9531,530.5,626.9531" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="528.5" x2="869.5" y1="626.9531" y2="626.9531"/><path d="M13,641.9531 L90,641.9531 L90,648.9531 L80,658.9531 L13,658.9531 L13,641.9531 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="608.5938" style="stroke: #A1A1CA; stroke-width: 2.0;" width="1079.5" x="13" y="641.9531"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="28" y="655.02">loop</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="320" x="105" y="654.1636">[for each Task With Budget (TwB) Zephyr Thread]</text><polygon fill="#F05772" points="853.5,691.3516,863.5,695.3516,853.5,699.3516,857.5,695.3516" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="523.5" x2="859.5" y1="695.3516" y2="695.3516"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="530.5" y="675.1528">schedule TwB Zephyr Thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="530.5" y="690.2856">(context switch)</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="875.5" x2="917.5" y1="724.4844" y2="724.4844"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="917.5" x2="917.5" y1="724.4844" y2="737.4844"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="876.5" x2="917.5" y1="737.4844" y2="737.4844"/><polygon fill="#F05772" points="886.5,733.4844,876.5,737.4844,886.5,741.4844,882.5,737.4844" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="882.5" y="719.4185">run</text><path d="M23,752.4844 L87,752.4844 L87,759.4844 L77,769.4844 L23,769.4844 L23,752.4844 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="491.0625" style="stroke: #A1A1CA; stroke-width: 2.0;" width="1059.5" x="23" y="752.4844"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="38" y="765.5513">alt</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="199" x="102" y="764.6948">[if time_slice (budget) timeout]</text><polygon fill="#F05772" points="534.5,786.75,524.5,790.75,534.5,794.75,530.5,790.75" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="528.5" x2="864.5" y1="790.75" y2="790.75"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="540.5" y="785.6841">time_slice timeout</text><polygon fill="#F05772" points="113.5,815.8828,103.5,819.8828,113.5,823.8828,109.5,819.8828" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="107.5" x2="512.5" y1="819.8828" y2="819.8828"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="119.5" y="814.8169">time_slice callback(thread)</text><polygon fill="#F05772" points="853.5,865.1484,863.5,869.1484,853.5,873.1484,857.5,869.1484" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="102.5" x2="859.5" y1="869.1484" y2="869.1484"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="109.5" y="864.0825">k_thread_priority_set(thread, LOW_PRIO)</text><path d="M880,832.8828 L880,887.8828 L1068,887.8828 L1068,842.8828 L1058,832.8828 L880,832.8828 " fill="#F6ED80" filter="url(#f37zls9jw0b9j)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M1058,832.8828 L1058,842.8828 L1068,842.8828 L1058,832.8828 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="886" y="849.9497">when budget is consumed</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="886" y="865.0825">reset time_slice to default</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="886" y="880.2153">and lower priority</text><polygon fill="#F05772" points="853.5,914.4141,863.5,918.4141,853.5,922.4141,857.5,918.4141" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="97.5" x2="859.5" y1="918.4141" y2="918.4141"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="342" x="104.5" y="913.3481">k_thread_time_slice_set(thread, slice_ticks = budget)</text><line style="stroke: #A1A1CA; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1082.5" y1="927.4141" y2="927.4141"/><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="307" x="28" y="937.6245">[if processing complete (no time_slice timeout)]</text><polygon fill="#F05772" points="113.5,958.3516,103.5,962.3516,113.5,966.3516,109.5,962.3516" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="107.5" x2="864.5" y1="962.3516" y2="962.3516"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="209" x="119.5" y="957.2856">on processing complete (thread)</text><polygon fill="#F05772" points="858.5,987.4844,868.5,991.4844,858.5,995.4844,862.5,991.4844" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="102.5" x2="864.5" y1="991.4844" y2="991.4844"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="109.5" y="986.4185">k_thread_runtime_stats_get(thread)</text><polygon fill="#F05772" points="113.5,1031.75,103.5,1035.75,113.5,1039.75,109.5,1035.75" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="107.5" x2="864.5" y1="1035.75" y2="1035.75"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="383" x="119.5" y="1015.5513">return thread_cycles - absolute number of cycles consumed</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="119.5" y="1030.6841">by thread</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="102.5" x2="144.5" y1="1095.1484" y2="1095.1484"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="144.5" x2="144.5" y1="1095.1484" y2="1108.1484"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="103.5" x2="144.5" y1="1108.1484" y2="1108.1484"/><polygon fill="#F05772" points="113.5,1104.1484,103.5,1108.1484,113.5,1112.1484,109.5,1108.1484" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="109.5" y="1059.8169">update thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="397" x="109.5" y="1074.9497">cycles_consumed_in_sys_tick += (thread_cycles - thread_ref_</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="109.5" y="1090.0825">cycles)</text><path d="M518,1057.8164 L518,1097.8164 L991,1097.8164 L991,1067.8164 L981,1057.8164 L518,1057.8164 " fill="#F6ED80" filter="url(#f37zls9jw0b9j)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M981,1057.8164 L981,1067.8164 L991,1067.8164 L981,1057.8164 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="452" x="524" y="1074.8833">thread_ref_cycles is a reference number of cycles consumed by thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="361" x="524" y="1090.0161">updated on each sys_tick start and processing complete</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="102.5" x2="144.5" y1="1137.2813" y2="1137.2813"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="144.5" x2="144.5" y1="1137.2813" y2="1150.2813"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="103.5" x2="144.5" y1="1150.2813" y2="1150.2813"/><polygon fill="#F05772" points="113.5,1146.2813,103.5,1150.2813,113.5,1154.2813,109.5,1150.2813" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="109.5" y="1132.2153">update thread_ref_cycles = thread_cycles</text><polygon fill="#F05772" points="853.5,1160.2813,863.5,1164.2813,853.5,1168.2813,857.5,1164.2813" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="97.5" x2="859.5" y1="1164.2813" y2="1164.2813"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="875.5" x2="917.5" y1="1208.5469" y2="1208.5469"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="917.5" x2="917.5" y1="1208.5469" y2="1221.5469"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="876.5" x2="917.5" y1="1221.5469" y2="1221.5469"/><polygon fill="#F05772" points="886.5,1217.5469,876.5,1221.5469,886.5,1225.5469,882.5,1221.5469" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="882.5" y="1188.3481">suspend TwB Zephyr Thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="882.5" y="1203.481">(k_sem_take)</text><path d="M324,1178.7813 L324,1218.7813 L856,1218.7813 L856,1188.7813 L846,1178.7813 L324,1178.7813 " fill="#F6ED80" filter="url(#f37zls9jw0b9j)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M846,1178.7813 L846,1188.7813 L856,1188.7813 L846,1178.7813 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="511" x="330" y="1195.8481">TwB Threads are expected to be resumed when there is new data for processing</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="383" x="330" y="1210.981">for example IPC TwB Thread will be resumed on IPC interrupt</text><polygon fill="#F05772" points="534.5,1231.5469,524.5,1235.5469,534.5,1239.5469,530.5,1235.5469" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="528.5" x2="869.5" y1="1235.5469" y2="1235.5469"/><path d="M438,1264.5469 L515,1264.5469 L515,1271.5469 L505,1281.5469 L438,1281.5469 L438,1264.5469 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="169.9297" style="stroke: #A1A1CA; stroke-width: 2.0;" width="788.5" x="438" y="1264.5469"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="453" y="1277.6138">loop</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="181" x="530" y="1276.7573">[for each DP Zephyr Thread]</text><polygon fill="#F05772" points="853.5,1326.5117,863.5,1330.5117,853.5,1334.5117,857.5,1330.5117" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="523.5" x2="859.5" y1="1330.5117" y2="1330.5117"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="323" x="530.5" y="1310.313">schedule DP Zephyr Thread with earlieast deadline</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="530.5" y="1325.4458">(context switch)</text><path d="M880,1286.6797 L880,1341.6797 L1212,1341.6797 L1212,1296.6797 L1202,1286.6797 L880,1286.6797 " fill="#F6ED80" filter="url(#f37zls9jw0b9j)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M1202,1286.6797 L1202,1296.6797 L1212,1296.6797 L1202,1286.6797 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="257" x="886" y="1303.7466">TwB Threads with low priority are treated</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="257" x="886" y="1318.8794">as threads with max deadline and will be</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="311" x="886" y="1334.0122">scheduled after DP threads complete processing</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="875.5" x2="917.5" y1="1385.8438" y2="1385.8438"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="917.5" x2="917.5" y1="1385.8438" y2="1398.8438"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="876.5" x2="917.5" y1="1398.8438" y2="1398.8438"/><polygon fill="#F05772" points="886.5,1394.8438,876.5,1398.8438,886.5,1402.8438,882.5,1398.8438" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="882.5" y="1380.7778">run</text><path d="M925,1356.0781 L925,1411.0781 L1154,1411.0781 L1154,1366.0781 L1144,1356.0781 L925,1356.0781 " fill="#F6ED80" filter="url(#f37zls9jw0b9j)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M1144,1356.0781 L1144,1366.0781 L1154,1366.0781 L1144,1356.0781 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="931" y="1373.145">DP thread runs till completion</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="931" y="1388.2778">or till earlier deadline or</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="931" y="1403.4106">higher priority thread is available</text><polygon fill="#F05772" points="534.5,1422.4766,524.5,1426.4766,534.5,1430.4766,530.5,1426.4766" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="528.5" x2="869.5" y1="1426.4766" y2="1426.4766"/><!--MD5=[976233c531fced4aa3e553e9259b3185]
@startuml
hidefootbox
skinparam componentStyle uml2

skinparam defaultFontColor	#33335b

skinparam rectangle {
	color		#d6d6de
	backgroundColor	#ffffff
}

skinparam component {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}

skinparam interface {
	backgroundColor	#ffffff
	borderColor	#f05772
}

skinparam class {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}
skinparam stereotypeCBackgroundColor	#6fccdd

skinparam sequence {
	arrowColor		#4a4a86
	lifeLineBorderColor	#f05772
	groupBorderColor	#a1a1ca
	boxBorderColor		#a1a1ca
	dividerBorderColor	#d6d6de
	dividerBorderThickness	1
}
skinparam participant {
	borderColor		#33335b
	backgroundColor		#ffffff
}
skinparam actor {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam state {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam node {
	backgroundColor		#ffffff
}

skinparam note {
	backgroundColor 	#f6ed80
	borderColor		#d6d6de
}

skinparam activity {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam activityDiamond {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam arrowColor	#f05772
skinparam maxMessageSize 400
skinparam BoxPadding 4

scale max 1280 width

skinparam maxMessageSize 400
skinparam BoxPadding 4

box "SOF" #LightBlue
	participant "MPP Scheduling"
	participant "Zephyr Scheduler"
	participant "Zephyr Thread"
	participant "Timer"
end box

"Timer" -> "MPP Scheduling": sys_tick callback
activate "MPP Scheduling"
	loop for each core
		"MPP Scheduling"-> "Zephyr Scheduler": resume LL Zephyr Thread\n(k_sem_give)
		activate "Zephyr Scheduler"
	end

	"MPP Scheduling"-> "MPP Scheduling": DP and Task with Budget\nZephyr Threads update

"Zephyr Scheduler"-> "Zephyr Thread": schedule LL Zephyr Thread\n(context switch)
 deactivate "MPP Scheduling"
	activate "Zephyr Thread"
	"Zephyr Thread"-> "Zephyr Thread": zephyr_ll_run
	activate "Zephyr Thread"

		loop for each LL pending task
		note left: LL pending tasks are scheduled operations\nthat are waiting for certain circumstances\n(like data arrival) to start processing
			opt if task is ready for processing
				"Zephyr Thread"-> "Zephyr Thread": move task \nto LL run queue
			end
		end

		loop for each task in LL queues
			"Zephyr Thread"-> "Zephyr Thread": run LL task callback
		end
	return

	"Zephyr Thread"-> "Zephyr Thread": suspend LL Zephyr Thread\n(k_sem_take)
	return

loop for each Task With Budget (TwB) Zephyr Thread
	"Zephyr Scheduler"-> "Zephyr Thread": schedule TwB Zephyr Thread\n(context switch)
		activate "Zephyr Thread"
		"Zephyr Thread"-> "Zephyr Thread": run

		alt if time_slice (budget) timeout
			"Zephyr Thread"-> "Zephyr Scheduler": time_slice timeout
				"Zephyr Scheduler"-> "MPP Scheduling": time_slice callback(thread)
				activate "MPP Scheduling"
					"MPP Scheduling"-> "Zephyr Thread": k_thread_priority_set(thread, LOW_PRIO)
					note right: when budget is consumed\nreset time_slice to default\nand lower priority
					"MPP Scheduling"-> "Zephyr Thread": k_thread_time_slice_set(thread, slice_ticks = budget)
				deactivate "MPP Scheduling"

		else if processing complete (no time_slice timeout)
			"Zephyr Thread"-> "MPP Scheduling": on processing complete (thread)
			activate "MPP Scheduling"
				"MPP Scheduling"-> "Zephyr Thread": k_thread_runtime_stats_get(thread)
				activate "Zephyr Thread"
					return return thread_cycles - absolute number of cycles consumed by thread
				"MPP Scheduling"->"MPP Scheduling": update thread\ncycles_consumed_in_sys_tick += (thread_cycles - thread_ref_cycles)
				note right: thread_ref_cycles is a reference number of cycles consumed by thread\nupdated on each sys_tick start and processing complete
				"MPP Scheduling"->"MPP Scheduling": update thread_ref_cycles = thread_cycles
				return
			deactivate "MPP Scheduling"

			"Zephyr Thread" -> "Zephyr Thread": suspend TwB Zephyr Thread\n(k_sem_take)
			note left: TwB Threads are expected to be resumed when there is new data for processing\nfor example IPC TwB Thread will be resumed on IPC interrupt
			"Zephyr Thread" - -> "Zephyr Scheduler"
			deactivate "Zephyr Thread"
		end
end

loop for each DP Zephyr Thread
	"Zephyr Scheduler"-> "Zephyr Thread": schedule DP Zephyr Thread with earlieast deadline\n(context switch)
	note right: TwB Threads with low priority are treated\nas threads with max deadline and will be\nscheduled after DP threads complete processing
	activate "Zephyr Thread"
		"Zephyr Thread"-> "Zephyr Thread": run
		note right: DP thread runs till completion\nor till earlier deadline or\nhigher priority thread is available
		return
	deactivate "Zephyr Thread"
end

@enduml

PlantUML version 1.2019.12(Sun Nov 03 10:24:54 UTC 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.26+4
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>