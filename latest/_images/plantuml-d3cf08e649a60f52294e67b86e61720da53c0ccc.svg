<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1524px" preserveAspectRatio="none" style="width:1138px;height:1524px;" version="1.1" viewBox="0 0 1138 1524" width="1138px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ldkuelsbhiys" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#ADD8E6" height="1502.3203" style="stroke: #A1A1CA; stroke-width: 1.0;" width="991.5" x="29" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="511.25" y="17.4951">SOF</text><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="185.4609" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="88.5" y="93.3125"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="103.4063" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="88.5" y="854.1016"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="210.4609" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="88.5" y="1003.6953"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="1337.9531" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="475.5" y="165.3672"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="373.8672" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="796.5" y="278.7734"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="239.9609" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="801.5" y="331.9766"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="563.1641" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="796.5" y="724.6953"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="46.7031" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="801.5" y="1034.0469"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="100.2305" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="796.5" y="1387.0898"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="65.0547" style="stroke: #A1A1CA; stroke-width: 2.0;" width="532.5" x="23" y="108.3125"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="110.4063" style="stroke: #A1A1CA; stroke-width: 2.0;" width="279" x="725.5" y="366.8281"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="78.0547" style="stroke: #A1A1CA; stroke-width: 2.0;" width="259" x="735.5" y="392.1797"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="61.7031" style="stroke: #A1A1CA; stroke-width: 2.0;" width="248" x="735.5" y="491.2344"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="635.2188" style="stroke: #A1A1CA; stroke-width: 2.0;" width="994.5" x="13" y="667.6406"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="512.8125" style="stroke: #A1A1CA; stroke-width: 2.0;" width="974.5" x="23" y="783.0469"/><rect fill="#FFFFFF" height="330.3516" style="stroke: none; stroke-width: 1.0;" width="974.5" x="23" y="965.5078"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="178.4609" style="stroke: #A1A1CA; stroke-width: 2.0;" width="722" x="405.5" y="1316.8594"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="93" x2="93" y1="60.9609" y2="1512.3203"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="480.5" x2="480.5" y1="60.9609" y2="1512.3203"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="801.5" x2="801.5" y1="60.9609" y2="1512.3203"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="989.5" x2="989.5" y1="60.9609" y2="1512.3203"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="117" x="33" y="24.3516"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="103" x="40" y="45.8848">MPP Scheduling</text><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="126" x="415.5" y="24.3516"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="422.5" y="45.8848">Zephyr Scheduler</text><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="108" x="745.5" y="24.3516"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="752.5" y="45.8848">Zephyr Thread</text><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="50" x="962.5" y="24.3516"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="969.5" y="45.8848">Timer</text><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="185.4609" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="88.5" y="93.3125"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="103.4063" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="88.5" y="854.1016"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="210.4609" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="88.5" y="1003.6953"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="1337.9531" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="475.5" y="165.3672"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="373.8672" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="796.5" y="278.7734"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="239.9609" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="801.5" y="331.9766"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="563.1641" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="796.5" y="724.6953"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="46.7031" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="801.5" y="1034.0469"/><rect fill="#FFFFFF" filter="url(#f1ldkuelsbhiys)" height="100.2305" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="796.5" y="1387.0898"/><polygon fill="#4A4A86" points="109.5,89.3125,99.5,93.3125,109.5,97.3125,105.5,93.3125" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="103.5" x2="988.5" y1="93.3125" y2="93.3125"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="115.5" y="88.4561">sys_tick callback</text><path d="M23,108.3125 L96,108.3125 L96,116.3125 L86,126.3125 L23,126.3125 L23,108.3125 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="65.0547" style="stroke: #A1A1CA; stroke-width: 2.0;" width="532.5" x="23" y="108.3125"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="38" y="122.8076">loop</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="81" x="111" y="121.7314">[for each core]</text><polygon fill="#4A4A86" points="463.5,161.3672,473.5,165.3672,463.5,169.3672,467.5,165.3672" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="98.5" x2="469.5" y1="165.3672" y2="165.3672"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="105.5" y="144.1592">resume LL Zephyr Thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="105.5" y="160.5107">(k_sem_give)</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="98.5" x2="140.5" y1="219.0703" y2="219.0703"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="140.5" x2="140.5" y1="219.0703" y2="232.0703"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="99.5" x2="140.5" y1="232.0703" y2="232.0703"/><polygon fill="#4A4A86" points="109.5,228.0703,99.5,232.0703,109.5,236.0703,105.5,232.0703" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="105.5" y="197.8623">DP and Task with Budget</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="105.5" y="214.2139">Zephyr Threads update</text><polygon fill="#4A4A86" points="784.5,274.7734,794.5,278.7734,784.5,282.7734,788.5,278.7734" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="485.5" x2="790.5" y1="278.7734" y2="278.7734"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="492.5" y="257.5654">schedule LL Zephyr Thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="492.5" y="273.917">(context switch)</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="806.5" x2="853.5" y1="318.9766" y2="318.9766"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="853.5" x2="853.5" y1="318.9766" y2="331.9766"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="812.5" x2="853.5" y1="331.9766" y2="331.9766"/><polygon fill="#4A4A86" points="822.5,327.9766,812.5,331.9766,822.5,335.9766,818.5,331.9766" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="818.5" y="314.1201">zephyr_ll_run</text><path d="M518,291.7734 L518,350.7734 L787,350.7734 L787,301.7734 L777,291.7734 L518,291.7734 " fill="#F6ED80" filter="url(#f1ldkuelsbhiys)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M777,291.7734 L777,301.7734 L787,301.7734 L777,291.7734 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="524" y="310.2686">LL pending tasks are scheduled operations</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="524" y="326.6201">that are waiting for certain circumstances</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="524" y="342.9717">(like data arrival) to start processing</text><path d="M725.5,366.8281 L798.5,366.8281 L798.5,374.8281 L788.5,384.8281 L725.5,384.8281 L725.5,366.8281 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="110.4063" style="stroke: #A1A1CA; stroke-width: 2.0;" width="279" x="725.5" y="366.8281"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="740.5" y="381.3232">loop</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="145" x="813.5" y="380.2471">[for each LL pending task]</text><path d="M735.5,392.1797 L800.5,392.1797 L800.5,400.1797 L790.5,410.1797 L735.5,410.1797 L735.5,392.1797 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="78.0547" style="stroke: #A1A1CA; stroke-width: 2.0;" width="259" x="735.5" y="392.1797"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="20" x="750.5" y="406.6748">opt</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="174" x="815.5" y="405.5986">[if task is ready for processing]</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="811.5" x2="853.5" y1="449.2344" y2="449.2344"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="853.5" x2="853.5" y1="449.2344" y2="462.2344"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="812.5" x2="853.5" y1="462.2344" y2="462.2344"/><polygon fill="#4A4A86" points="822.5,458.2344,812.5,462.2344,822.5,466.2344,818.5,462.2344" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="818.5" y="428.0264">move task</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="818.5" y="444.3779">to LL run queue</text><path d="M735.5,491.2344 L808.5,491.2344 L808.5,499.2344 L798.5,509.2344 L735.5,509.2344 L735.5,491.2344 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="61.7031" style="stroke: #A1A1CA; stroke-width: 2.0;" width="248" x="735.5" y="491.2344"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="750.5" y="505.7295">loop</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="823.5" y="504.6533">[for each task in LL queues]</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="811.5" x2="853.5" y1="531.9375" y2="531.9375"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="853.5" x2="853.5" y1="531.9375" y2="544.9375"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="812.5" x2="853.5" y1="544.9375" y2="544.9375"/><polygon fill="#4A4A86" points="822.5,540.9375,812.5,544.9375,822.5,548.9375,818.5,544.9375" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="818.5" y="527.0811">run LL task callback</text><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="811.5" x2="853.5" y1="570.9375" y2="570.9375"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="853.5" x2="853.5" y1="570.9375" y2="583.9375"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="806.5" x2="853.5" y1="583.9375" y2="583.9375"/><polygon fill="#4A4A86" points="816.5,579.9375,806.5,583.9375,816.5,587.9375,812.5,583.9375" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="806.5" x2="848.5" y1="625.6406" y2="625.6406"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="848.5" x2="848.5" y1="625.6406" y2="638.6406"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="807.5" x2="848.5" y1="638.6406" y2="638.6406"/><polygon fill="#4A4A86" points="817.5,634.6406,807.5,638.6406,817.5,642.6406,813.5,638.6406" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="813.5" y="604.4326">suspend LL Zephyr Thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="813.5" y="620.7842">(k_sem_take)</text><polygon fill="#4A4A86" points="496.5,648.6406,486.5,652.6406,496.5,656.6406,492.5,652.6406" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="490.5" x2="800.5" y1="652.6406" y2="652.6406"/><path d="M13,667.6406 L86,667.6406 L86,675.6406 L76,685.6406 L13,685.6406 L13,667.6406 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="635.2188" style="stroke: #A1A1CA; stroke-width: 2.0;" width="994.5" x="13" y="667.6406"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="28" y="682.1357">loop</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="271" x="101" y="681.0596">[for each Task With Budget (TwB) Zephyr Thread]</text><polygon fill="#4A4A86" points="784.5,720.6953,794.5,724.6953,784.5,728.6953,788.5,724.6953" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="485.5" x2="790.5" y1="724.6953" y2="724.6953"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="492.5" y="703.4873">schedule TwB Zephyr Thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="492.5" y="719.8389">(context switch)</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="806.5" x2="848.5" y1="755.0469" y2="755.0469"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="848.5" x2="848.5" y1="755.0469" y2="768.0469"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="807.5" x2="848.5" y1="768.0469" y2="768.0469"/><polygon fill="#4A4A86" points="817.5,764.0469,807.5,768.0469,817.5,772.0469,813.5,768.0469" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="813.5" y="750.1904">run</text><path d="M23,783.0469 L84,783.0469 L84,791.0469 L74,801.0469 L23,801.0469 L23,783.0469 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="512.8125" style="stroke: #A1A1CA; stroke-width: 2.0;" width="974.5" x="23" y="783.0469"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="38" y="797.542">alt</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="171" x="99" y="796.4658">[if time_slice (budget) timeout]</text><polygon fill="#4A4A86" points="496.5,819.75,486.5,823.75,496.5,827.75,492.5,823.75" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="490.5" x2="795.5" y1="823.75" y2="823.75"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="502.5" y="818.8936">time_slice timeout</text><polygon fill="#4A4A86" points="109.5,850.1016,99.5,854.1016,109.5,858.1016,105.5,854.1016" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="103.5" x2="474.5" y1="854.1016" y2="854.1016"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="115.5" y="849.2451">time_slice callback(thread)</text><polygon fill="#4A4A86" points="784.5,901.8047,794.5,905.8047,784.5,909.8047,788.5,905.8047" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="98.5" x2="790.5" y1="905.8047" y2="905.8047"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="105.5" y="900.9482">k_thread_priority_set(thread, LOW_PRIO)</text><path d="M811,867.1016 L811,926.1016 L983,926.1016 L983,877.1016 L973,867.1016 L811,867.1016 " fill="#F6ED80" filter="url(#f1ldkuelsbhiys)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M973,867.1016 L973,877.1016 L983,877.1016 L973,867.1016 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="817" y="885.5967">when budget is consumed</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="817" y="901.9482">reset time_slice to default</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="817" y="918.2998">and lower priority</text><polygon fill="#4A4A86" points="784.5,953.5078,794.5,957.5078,784.5,961.5078,788.5,957.5078" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="93.5" x2="790.5" y1="957.5078" y2="957.5078"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="310" x="100.5" y="952.6514">k_thread_time_slice_set(thread, slice_ticks = budget)</text><line style="stroke: #A1A1CA; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="997.5" y1="966.5078" y2="966.5078"/><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="267" x="28" y="977.9268">[if processing complete (no time_slice timeout)]</text><polygon fill="#4A4A86" points="109.5,999.6953,99.5,1003.6953,109.5,1007.6953,105.5,1003.6953" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="103.5" x2="795.5" y1="1003.6953" y2="1003.6953"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="115.5" y="998.8389">on processing complete (thread)</text><polygon fill="#4A4A86" points="789.5,1030.0469,799.5,1034.0469,789.5,1038.0469,793.5,1034.0469" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="98.5" x2="795.5" y1="1034.0469" y2="1034.0469"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="105.5" y="1029.1904">k_thread_runtime_stats_get(thread)</text><polygon fill="#4A4A86" points="109.5,1076.75,99.5,1080.75,109.5,1084.75,105.5,1080.75" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="103.5" x2="795.5" y1="1080.75" y2="1080.75"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="364" x="115.5" y="1059.542">return thread_cycles - absolute number of cycles consumed by</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="115.5" y="1075.8936">thread</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="98.5" x2="140.5" y1="1143.8047" y2="1143.8047"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="140.5" x2="140.5" y1="1143.8047" y2="1156.8047"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="99.5" x2="140.5" y1="1156.8047" y2="1156.8047"/><polygon fill="#4A4A86" points="109.5,1152.8047,99.5,1156.8047,109.5,1160.8047,105.5,1156.8047" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="105.5" y="1106.2451">update thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="363" x="105.5" y="1122.5967">cycles_consumed_in_sys_tick += (thread_cycles - thread_ref_</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="105.5" y="1138.9482">cycles)</text><path d="M480,1103.4258 L480,1145.4258 L910,1145.4258 L910,1113.4258 L900,1103.4258 L480,1103.4258 " fill="#F6ED80" filter="url(#f1ldkuelsbhiys)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M900,1103.4258 L900,1113.4258 L910,1113.4258 L900,1103.4258 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="409" x="486" y="1121.9209">thread_ref_cycles is a reference number of cycles consumed by thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="328" x="486" y="1138.2725">updated on each sys_tick start and processing complete</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="98.5" x2="140.5" y1="1187.1563" y2="1187.1563"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="140.5" x2="140.5" y1="1187.1563" y2="1200.1563"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="99.5" x2="140.5" y1="1200.1563" y2="1200.1563"/><polygon fill="#4A4A86" points="109.5,1196.1563,99.5,1200.1563,109.5,1204.1563,105.5,1200.1563" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="242" x="105.5" y="1182.2998">update thread_ref_cycles = thread_cycles</text><polygon fill="#4A4A86" points="784.5,1210.1563,794.5,1214.1563,784.5,1218.1563,788.5,1214.1563" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="93.5" x2="790.5" y1="1214.1563" y2="1214.1563"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="806.5" x2="848.5" y1="1260.8594" y2="1260.8594"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="848.5" x2="848.5" y1="1260.8594" y2="1273.8594"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="807.5" x2="848.5" y1="1273.8594" y2="1273.8594"/><polygon fill="#4A4A86" points="817.5,1269.8594,807.5,1273.8594,817.5,1277.8594,813.5,1273.8594" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="813.5" y="1239.6514">suspend TwB Zephyr Thread</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="813.5" y="1256.0029">(k_sem_take)</text><path d="M303,1228.6563 L303,1270.6563 L787,1270.6563 L787,1238.6563 L777,1228.6563 L303,1228.6563 " fill="#F6ED80" filter="url(#f1ldkuelsbhiys)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M777,1228.6563 L777,1238.6563 L787,1238.6563 L777,1228.6563 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="463" x="309" y="1247.1514">TwB Threads are expected to be resumed when there is new data for processing</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="352" x="309" y="1263.5029">for example IPC TwB Thread will be resumed on IPC interrupt</text><polygon fill="#4A4A86" points="496.5,1283.8594,486.5,1287.8594,496.5,1291.8594,492.5,1287.8594" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="490.5" x2="800.5" y1="1287.8594" y2="1287.8594"/><path d="M405.5,1316.8594 L478.5,1316.8594 L478.5,1324.8594 L468.5,1334.8594 L405.5,1334.8594 L405.5,1316.8594 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="178.4609" style="stroke: #A1A1CA; stroke-width: 2.0;" width="722" x="405.5" y="1316.8594"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="420.5" y="1331.3545">loop</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154" x="493.5" y="1330.2783">[for each DP Zephyr Thread]</text><polygon fill="#4A4A86" points="784.5,1383.0898,794.5,1387.0898,784.5,1391.0898,788.5,1387.0898" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="485.5" x2="790.5" y1="1387.0898" y2="1387.0898"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="492.5" y="1365.8818">schedule DP Zephyr Thread with earlieast deadline</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="492.5" y="1382.2334">(context switch)</text><path d="M811,1340.2109 L811,1399.2109 L1113,1399.2109 L1113,1350.2109 L1103,1340.2109 L811,1340.2109 " fill="#F6ED80" filter="url(#f1ldkuelsbhiys)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M1103,1340.2109 L1103,1350.2109 L1113,1350.2109 L1103,1340.2109 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="817" y="1358.7061">TwB Threads with low priority are treated</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="817" y="1375.0576">as threads with max deadline and will be</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="281" x="817" y="1391.4092">scheduled after DP threads complete processing</text><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="806.5" x2="848.5" y1="1445.4688" y2="1445.4688"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="848.5" x2="848.5" y1="1445.4688" y2="1458.4688"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="807.5" x2="848.5" y1="1458.4688" y2="1458.4688"/><polygon fill="#4A4A86" points="817.5,1454.4688,807.5,1458.4688,817.5,1462.4688,813.5,1458.4688" style="stroke: #4A4A86; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="813.5" y="1440.6123">run</text><path d="M856,1413.2656 L856,1472.2656 L1062,1472.2656 L1062,1423.2656 L1052,1413.2656 L856,1413.2656 " fill="#F6ED80" filter="url(#f1ldkuelsbhiys)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M1052,1413.2656 L1052,1423.2656 L1062,1423.2656 L1052,1413.2656 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="862" y="1431.7607">DP thread runs till completion</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="862" y="1448.1123">or till earlier deadline or</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="862" y="1464.4639">higher priority thread is available</text><polygon fill="#4A4A86" points="496.5,1483.3203,486.5,1487.3203,496.5,1491.3203,492.5,1487.3203" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="490.5" x2="800.5" y1="1487.3203" y2="1487.3203"/><!--MD5=[91a2d338366953b392a761bda61ab601]
@startuml
hidefootbox
skinparam componentStyle uml2

skinparam defaultFontColor	#33335b

skinparam rectangle {
	color		#d6d6de
	backgroundColor	#ffffff
}

skinparam component {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}

skinparam interface {
	backgroundColor	#ffffff
	borderColor	#f05772
}

skinparam class {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}
skinparam stereotypeCBackgroundColor	#6fccdd

skinparam sequence {
	arrowColor		#4a4a86
	lifeLineBorderColor	#f05772
	groupBorderColor	#a1a1ca
	boxBorderColor		#a1a1ca
	dividerBorderColor	#d6d6de
	dividerBorderThickness	1
}
skinparam participant {
	borderColor		#33335b
	backgroundColor		#ffffff
}
skinparam actor {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam state {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam node {
	backgroundColor		#ffffff
}

skinparam note {
	backgroundColor 	#f6ed80
	borderColor		#d6d6de
}

scale max 1280 width

skinparam maxMessageSize 400
skinparam BoxPadding 4

box "SOF" #LightBlue
	participant "MPP Scheduling"
	participant "Zephyr Scheduler"
	participant "Zephyr Thread"
	participant "Timer"
end box

"Timer" -> "MPP Scheduling": sys_tick callback
activate "MPP Scheduling"
	loop for each core
		"MPP Scheduling"-> "Zephyr Scheduler": resume LL Zephyr Thread\n(k_sem_give)
		activate "Zephyr Scheduler"
	end

	"MPP Scheduling"-> "MPP Scheduling": DP and Task with Budget\nZephyr Threads update

"Zephyr Scheduler"-> "Zephyr Thread": schedule LL Zephyr Thread\n(context switch)
 deactivate "MPP Scheduling"
	activate "Zephyr Thread"
	"Zephyr Thread"-> "Zephyr Thread": zephyr_ll_run
	activate "Zephyr Thread"

		loop for each LL pending task
		note left: LL pending tasks are scheduled operations\nthat are waiting for certain circumstances\n(like data arrival) to start processing
			opt if task is ready for processing
				"Zephyr Thread"-> "Zephyr Thread": move task \nto LL run queue
			end
		end

		loop for each task in LL queues
			"Zephyr Thread"-> "Zephyr Thread": run LL task callback
		end
	return

	"Zephyr Thread"-> "Zephyr Thread": suspend LL Zephyr Thread\n(k_sem_take)
	return

loop for each Task With Budget (TwB) Zephyr Thread
	"Zephyr Scheduler"-> "Zephyr Thread": schedule TwB Zephyr Thread\n(context switch)
		activate "Zephyr Thread"
		"Zephyr Thread"-> "Zephyr Thread": run

		alt if time_slice (budget) timeout
			"Zephyr Thread"-> "Zephyr Scheduler": time_slice timeout
				"Zephyr Scheduler"-> "MPP Scheduling": time_slice callback(thread)
				activate "MPP Scheduling"
					"MPP Scheduling"-> "Zephyr Thread": k_thread_priority_set(thread, LOW_PRIO)
					note right: when budget is consumed\nreset time_slice to default\nand lower priority
					"MPP Scheduling"-> "Zephyr Thread": k_thread_time_slice_set(thread, slice_ticks = budget)
				deactivate "MPP Scheduling"

		else if processing complete (no time_slice timeout)
			"Zephyr Thread"-> "MPP Scheduling": on processing complete (thread)
			activate "MPP Scheduling"
				"MPP Scheduling"-> "Zephyr Thread": k_thread_runtime_stats_get(thread)
				activate "Zephyr Thread"
					return return thread_cycles - absolute number of cycles consumed by thread
				"MPP Scheduling"->"MPP Scheduling": update thread\ncycles_consumed_in_sys_tick += (thread_cycles - thread_ref_cycles)
				note right: thread_ref_cycles is a reference number of cycles consumed by thread\nupdated on each sys_tick start and processing complete
				"MPP Scheduling"->"MPP Scheduling": update thread_ref_cycles = thread_cycles
				return
			deactivate "MPP Scheduling"

			"Zephyr Thread" -> "Zephyr Thread": suspend TwB Zephyr Thread\n(k_sem_take)
			note left: TwB Threads are expected to be resumed when there is new data for processing\nfor example IPC TwB Thread will be resumed on IPC interrupt
			"Zephyr Thread" - -> "Zephyr Scheduler"
			deactivate "Zephyr Thread"
		end
end

loop for each DP Zephyr Thread
	"Zephyr Scheduler"-> "Zephyr Thread": schedule DP Zephyr Thread with earlieast deadline\n(context switch)
	note right: TwB Threads with low priority are treated\nas threads with max deadline and will be\nscheduled after DP threads complete processing
	activate "Zephyr Thread"
		"Zephyr Thread"-> "Zephyr Thread": run
		note right: DP thread runs till completion\nor till earlier deadline or\nhigher priority thread is available
		return
	deactivate "Zephyr Thread"
end

@enduml

PlantUML version 1.2019.12(Sun Nov 03 11:24:54 CET 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_302-b08
Operating System: Windows 10
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>