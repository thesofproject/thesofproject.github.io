<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="462px" preserveAspectRatio="none" style="width:600px;height:462px;" version="1.1" viewBox="0 0 600 462" width="600px" zoomAndPan="magnify"><defs><filter height="300%" id="f18gqjp8o5ot6c" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" height="440.0859" style="stroke: #A1A1CA; stroke-width: 1.0;" width="64" x="29" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="47.5" y="17.4951">Host</text><rect fill="#DDDDDD" height="440.0859" style="stroke: #A1A1CA; stroke-width: 1.0;" width="147" x="189" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57" x="234" y="17.4951">HD/A HW</text><rect fill="#FFFFFF" height="440.0859" style="stroke: #A1A1CA; stroke-width: 1.0;" width="158" x="338" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="403.5" y="17.4951">DSP</text><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="61" x2="61" y1="78.5703" y2="450.0859"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="226" x2="226" y1="78.5703" y2="450.0859"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="300" x2="300" y1="78.5703" y2="450.0859"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="364" x2="364" y1="78.5703" y2="450.0859"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="453" x2="453" y1="78.5703" y2="450.0859"/><rect fill="#FFFFFF" filter="url(#f18gqjp8o5ot6c)" height="49.2188" style="stroke: #33335B; stroke-width: 1.5;" width="52" x="33" y="24.3516"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="45" y="45.8848">Host</text><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="40" y="63.4941">Driver</text><rect fill="#FFFFFF" filter="url(#f18gqjp8o5ot6c)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="62" x="193" y="41.9609"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="200" y="63.4941">hda_sw</text><rect fill="#FFFFFF" filter="url(#f18gqjp8o5ot6c)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="59" x="269" y="41.9609"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="276" y="63.4941">hda_fw</text><rect fill="#FFFFFF" filter="url(#f18gqjp8o5ot6c)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="41" x="342" y="41.9609"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="349" y="63.4941">host</text><rect fill="#FFFFFF" filter="url(#f18gqjp8o5ot6c)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="73" x="415" y="41.9609"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="422" y="63.4941">hda_dma</text><path d="M176,93.5703 L176,119.5703 L345,119.5703 L345,103.5703 L335,93.5703 L176,93.5703 " fill="#F6ED80" filter="url(#f18gqjp8o5ot6c)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M335,93.5703 L335,103.5703 L345,103.5703 L335,93.5703 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="182" y="112.0654">"DMA in RUNNING state"</text><polygon fill="#4A4A86" points="49,147.2734,59,151.2734,49,155.2734,53,151.2734" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="3" x2="55" y1="151.2734" y2="151.2734"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="10" y="146.417">Stop?</text><polygon fill="#4A4A86" points="352.5,182.625,362.5,186.625,352.5,190.625,356.5,186.625" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="61" x2="358.5" y1="186.625" y2="186.625"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="68" y="181.7686">COMP_TRIGGER_PAUSE ?</text><path d="M369,164.2734 L369,190.2734 L588,190.2734 L588,174.2734 L578,164.2734 L369,164.2734 " fill="#F6ED80" filter="url(#f18gqjp8o5ot6c)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M578,164.2734 L578,174.2734 L588,174.2734 L578,164.2734 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="198" x="375" y="182.7686">No more FPI touching at this point</text><polygon fill="#4A4A86" points="72,201.625,62,205.625,72,209.625,68,205.625" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="66" x2="363.5" y1="205.625" y2="205.625"/><polygon fill="#4A4A86" points="214,231.9766,224,235.9766,214,239.9766,218,235.9766" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="61" x2="220" y1="235.9766" y2="235.9766"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="68" y="231.1201">RUN := 0</text><polygon fill="#4A4A86" points="352.5,262.3281,362.5,266.3281,352.5,270.3281,356.5,266.3281" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="61" x2="358.5" y1="266.3281" y2="266.3281"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="68" y="261.4717">COMP_TRIGGER_STOP</text><polygon fill="#4A4A86" points="441.5,292.6797,451.5,296.6797,441.5,300.6797,445.5,296.6797" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="364.5" x2="447.5" y1="296.6797" y2="296.6797"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="371.5" y="291.8232">dma_stop()</text><polygon fill="#4A4A86" points="311.5,323.0313,301.5,327.0313,311.5,331.0313,307.5,327.0313" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="305.5" x2="452.5" y1="327.0313" y2="327.0313"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="317.5" y="322.1748">GEN := 0</text><polygon fill="#4A4A86" points="311.5,353.3828,301.5,357.3828,311.5,361.3828,307.5,357.3828" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="305.5" x2="452.5" y1="357.3828" y2="357.3828"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="317.5" y="352.5264">FIFORDY := 0</text><polygon fill="#4A4A86" points="375.5,367.3828,365.5,371.3828,375.5,375.3828,371.5,371.3828" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="369.5" x2="452.5" y1="371.3828" y2="371.3828"/><polygon fill="#4A4A86" points="72,381.3828,62,385.3828,72,389.3828,68,385.3828" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="66" x2="363.5" y1="385.3828" y2="385.3828"/><polygon fill="#4A4A86" points="214,428.0859,224,432.0859,214,436.0859,218,432.0859" style="stroke: #4A4A86; stroke-width: 1.0;"/><line style="stroke: #4A4A86; stroke-width: 1.0;" x1="61" x2="220" y1="432.0859" y2="432.0859"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="68" y="410.8779">Flush DMA,</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="68" y="427.2295">set SRST (stream reset)</text><!--MD5=[37a41a9ce66c98da25d5320353cb03a6]
@startuml
hidefootbox
skinparam componentStyle uml2

skinparam defaultFontColor	#33335b

skinparam rectangle {
	color		#d6d6de
	backgroundColor	#ffffff
}

skinparam component {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}

skinparam interface {
	backgroundColor	#ffffff
	borderColor	#f05772
}

skinparam class {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}
skinparam stereotypeCBackgroundColor	#6fccdd

skinparam sequence {
	arrowColor		#4a4a86
	lifeLineBorderColor	#f05772
	groupBorderColor	#a1a1ca
	boxBorderColor		#a1a1ca
	dividerBorderColor	#d6d6de
	dividerBorderThickness	1
}
skinparam participant {
	borderColor		#33335b
	backgroundColor		#ffffff
}
skinparam actor {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam state {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam node {
	backgroundColor		#ffffff
}

skinparam note {
	backgroundColor 	#f6ed80
	borderColor		#d6d6de
}
box "Host" #ffffff
    participant "Host\nDriver" as drv
end box
box "HD/A HW"
	participant hda_sw
	participant hda_fw
end box
box "DSP" #ffffff
    participant host
    participant hda_dma
end box

note over hda_sw, hda_fw: "DMA in RUNNING state"

-> drv : Stop?

    drv -> host : COMP_TRIGGER_PAUSE ?
            note right : No more FPI touching at this point
        drv <- - host

    drv -> hda_sw : RUN := 0

    drv -> host : COMP_TRIGGER_STOP
        host -> hda_dma : dma_stop()
            hda_fw <- hda_dma : GEN := 0
            hda_fw <- hda_dma : FIFORDY := 0
            host <- - hda_dma
        drv <- - host

    drv -> hda_sw : Flush DMA,\nset SRST (stream reset)

@enduml

PlantUML version 1.2019.12(Sun Nov 03 11:24:54 CET 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_302-b08
Operating System: Windows 10
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>