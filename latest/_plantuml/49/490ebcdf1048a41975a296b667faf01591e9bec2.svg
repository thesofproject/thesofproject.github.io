<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="975px" preserveAspectRatio="none" style="width:1214px;height:975px;" version="1.1" viewBox="0 0 1214 975" width="1214px" zoomAndPan="magnify"><defs><filter height="300%" id="f1jn53nz9l8e28" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#90EE90" height="953.3984" style="stroke: #A1A1CA; stroke-width: 1.0;" width="64" x="8" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="26.5" y="17.4951">Host</text><rect fill="#87CEFA" height="953.3984" style="stroke: #A1A1CA; stroke-width: 1.0;" width="694" x="114.5" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="215" x="354" y="17.4951">Media Processing Pipelines Layer</text><rect fill="#ADD8E6" height="953.3984" style="stroke: #A1A1CA; stroke-width: 1.0;" width="204" x="818.5" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="83" x="879" y="17.4951">Zephyr RTOS</text><rect fill="#D3D3D3" height="953.3984" style="stroke: #A1A1CA; stroke-width: 1.0;" width="76" x="1053.5" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="1060.5" y="17.4951">Hardware</text><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="692.9766" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="189" y="261.4219"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="91.0547" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="343" y="93.3125"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="563.9219" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="343" y="317.125"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="30.3516" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="719" y="140.0156"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="120.0547" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="915.5" y="416.1797"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="19" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="915.5" y="658.2891"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="120.0547" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="915.5" y="739.9922"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="612.625" style="stroke: #A1A1CA; stroke-width: 2.0;" width="1095" x="108.5" y="276.4219"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="353.1641" style="stroke: #A1A1CA; stroke-width: 2.0;" width="916.5" x="277" y="332.125"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="48.7031" style="stroke: #A1A1CA; stroke-width: 2.0;" width="371" x="812.5" y="474.5313"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="168.7578" style="stroke: #A1A1CA; stroke-width: 2.0;" width="916.5" x="277" y="699.2891"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="48.7031" style="stroke: #A1A1CA; stroke-width: 2.0;" width="371" x="812.5" y="798.3438"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="40" x2="40" y1="60.9609" y2="963.3984"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="193.5" x2="193.5" y1="60.9609" y2="963.3984"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="348" x2="348" y1="60.9609" y2="963.3984"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="723.5" x2="723.5" y1="60.9609" y2="963.3984"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="920.5" x2="920.5" y1="60.9609" y2="963.3984"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1091.5" x2="1091.5" y1="60.9609" y2="963.3984"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="52" x="12" y="24.3516"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="19" y="45.8848">Driver</text><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="147" x="118.5" y="24.3516"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="133" x="125.5" y="45.8848">Component Manager</text><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="118" x="287" y="24.3516"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="294" y="45.8848">Library Manager</text><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="157" x="643.5" y="24.3516"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="143" x="650.5" y="45.8848">MPP Memory Manager</text><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="192" x="822.5" y="24.3516"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="178" x="829.5" y="45.8848">Memory Management Driver</text><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="31.6094" style="stroke: #33335B; stroke-width: 1.5;" width="64" x="1057.5" y="24.3516"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="1064.5" y="45.8848">Memory</text><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="692.9766" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="189" y="261.4219"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="91.0547" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="343" y="93.3125"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="563.9219" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="343" y="317.125"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="30.3516" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="719" y="140.0156"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="120.0547" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="915.5" y="416.1797"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="19" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="915.5" y="658.2891"/><rect fill="#FFFFFF" filter="url(#f1jn53nz9l8e28)" height="120.0547" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="915.5" y="739.9922"/><polygon fill="#F05772" points="331,89.3125,341,93.3125,331,97.3125,335,93.3125" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="40" x2="337" y1="93.3125" y2="93.3125"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="47" y="88.4561">Load Library</text><polygon fill="#F05772" points="707,136.0156,717,140.0156,707,144.0156,711,140.0156" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="353" x2="713" y1="140.0156" y2="140.0156"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="347" x="360" y="118.8076">rmalloc(MEM_ZONE_RUNTIME, flags=NULL, MEM_CAPS_</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="360" y="135.1592">LOADABLE_LIBRARY, size)</text><polygon fill="#F05772" points="364,166.3672,354,170.3672,364,174.3672,360,170.3672" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="358" x2="723" y1="170.3672" y2="170.3672"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="370" y="165.5107">address to store library</text><polygon fill="#F05772" points="51,180.3672,41,184.3672,51,188.3672,47,184.3672" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="45" x2="347" y1="184.3672" y2="184.3672"/><polygon fill="#F05772" points="336,227.0703,346,231.0703,336,235.0703,340,231.0703" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="40" x2="342" y1="231.0703" y2="231.0703"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="47" y="209.8623">Transfer library over DMA</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="47" y="226.2139">to given address</text><polygon fill="#F05772" points="177,257.4219,187,261.4219,177,265.4219,181,261.4219" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="40" x2="183" y1="261.4219" y2="261.4219"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="47" y="256.5654">Instantiate Component</text><path d="M108.5,276.4219 L173.5,276.4219 L173.5,284.4219 L163.5,294.4219 L108.5,294.4219 L108.5,276.4219 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="612.625" style="stroke: #A1A1CA; stroke-width: 2.0;" width="1095" x="108.5" y="276.4219"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="20" x="123.5" y="290.917">opt</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="271" x="188.5" y="289.8408">[if Component is Loadable and it is first instance]</text><polygon fill="#F05772" points="331,313.125,341,317.125,331,321.125,335,317.125" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="199" x2="337" y1="317.125" y2="317.125"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="206" y="312.2686">Load component</text><path d="M277,332.125 L350,332.125 L350,340.125 L340,350.125 L277,350.125 L277,332.125 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="353.1641" style="stroke: #A1A1CA; stroke-width: 2.0;" width="916.5" x="277" y="332.125"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="292" y="346.6201">loop</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="212" x="365" y="345.5439">[repeat for Component TEXT, RODATA]</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="353" x2="395" y1="372.8281" y2="372.8281"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="395" x2="395" y1="372.8281" y2="385.8281"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="354" x2="395" y1="385.8281" y2="385.8281"/><polygon fill="#F05772" points="364,381.8281,354,385.8281,364,389.8281,360,385.8281" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="317" x="360" y="367.9717">read Component virtual address and size from manifest</text><polygon fill="#F05772" points="903.5,412.1797,913.5,416.1797,903.5,420.1797,907.5,416.1797" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="353" x2="909.5" y1="416.1797" y2="416.1797"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="359" x="360" y="411.3232">sys_mm_drv_map_region(virt*, phys=NULL, size, flags=NULL)</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="925.5" x2="967.5" y1="446.5313" y2="446.5313"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="967.5" x2="967.5" y1="446.5313" y2="459.5313"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="926.5" x2="967.5" y1="459.5313" y2="459.5313"/><polygon fill="#F05772" points="936.5,455.5313,926.5,459.5313,936.5,463.5313,932.5,459.5313" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="932.5" y="441.6748">allocate free phys pages</text><path d="M812.5,474.5313 L877.5,474.5313 L877.5,482.5313 L867.5,492.5313 L812.5,492.5313 L812.5,474.5313 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="48.7031" style="stroke: #A1A1CA; stroke-width: 2.0;" width="371" x="812.5" y="474.5313"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="20" x="827.5" y="489.0264">opt</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="286" x="892.5" y="487.9502">[power up memory banks for allocated phys pages]</text><polygon fill="#F05772" points="1079.5,511.2344,1089.5,515.2344,1079.5,519.2344,1083.5,515.2344" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="925.5" x2="1085.5" y1="515.2344" y2="515.2344"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="932.5" y="510.3779">power up memory banks</text><polygon fill="#F05772" points="364,532.2344,354,536.2344,364,540.2344,360,536.2344" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="358" x2="919.5" y1="536.2344" y2="536.2344"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="353" x2="395" y1="566.5859" y2="566.5859"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="395" x2="395" y1="566.5859" y2="579.5859"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="354" x2="395" y1="579.5859" y2="579.5859"/><polygon fill="#F05772" points="364,575.5859,354,579.5859,364,583.5859,360,579.5859" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="301" x="360" y="561.7295">read Component address offset from library manifest</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="353" x2="395" y1="609.9375" y2="609.9375"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="395" x2="395" y1="609.9375" y2="622.9375"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="354" x2="395" y1="622.9375" y2="622.9375"/><polygon fill="#F05772" points="364,618.9375,354,622.9375,364,626.9375,360,622.9375" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="360" y="605.0811">mem_copy(virt*, library_store_addr + offset, size)</text><polygon fill="#F05772" points="903.5,654.2891,913.5,658.2891,903.5,662.2891,907.5,658.2891" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="353" x2="909.5" y1="658.2891" y2="658.2891"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="371" x="360" y="653.4326">sys_mm_drv_update_region(virt*, size, flags= CODE / RODATA)</text><path d="M930,635.9375 L930,661.9375 L1174,661.9375 L1174,645.9375 L1164,635.9375 L930,635.9375 " fill="#F6ED80" filter="url(#f1jn53nz9l8e28)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M1164,635.9375 L1164,645.9375 L1174,645.9375 L1164,635.9375 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="936" y="654.4326">update region flags to prevent overwrite</text><polygon fill="#F05772" points="364,673.2891,354,677.2891,364,681.2891,360,677.2891" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="358" x2="919.5" y1="677.2891" y2="677.2891"/><path d="M277,699.2891 L342,699.2891 L342,707.2891 L332,717.2891 L277,717.2891 L277,699.2891 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="168.7578" style="stroke: #A1A1CA; stroke-width: 2.0;" width="916.5" x="277" y="699.2891"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="20" x="292" y="713.7842">opt</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="130" x="357" y="712.708">[if Component has BSS]</text><polygon fill="#F05772" points="903.5,735.9922,913.5,739.9922,903.5,743.9922,907.5,739.9922" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="353" x2="909.5" y1="739.9922" y2="739.9922"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="347" x="360" y="735.1357">sys_mm_drv_map_region(virt*, phys=NULL, bss_size, flags)</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="925.5" x2="967.5" y1="770.3438" y2="770.3438"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="967.5" x2="967.5" y1="770.3438" y2="783.3438"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="926.5" x2="967.5" y1="783.3438" y2="783.3438"/><polygon fill="#F05772" points="936.5,779.3438,926.5,783.3438,936.5,787.3438,932.5,783.3438" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="932.5" y="765.4873">allocate free phys pages</text><path d="M812.5,798.3438 L877.5,798.3438 L877.5,806.3438 L867.5,816.3438 L812.5,816.3438 L812.5,798.3438 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="48.7031" style="stroke: #A1A1CA; stroke-width: 2.0;" width="371" x="812.5" y="798.3438"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="20" x="827.5" y="812.8389">opt</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="286" x="892.5" y="811.7627">[power up memory banks for allocated phys pages]</text><polygon fill="#F05772" points="1079.5,835.0469,1089.5,839.0469,1079.5,843.0469,1083.5,839.0469" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="925.5" x2="1085.5" y1="839.0469" y2="839.0469"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="932.5" y="834.1904">power up memory banks</text><polygon fill="#F05772" points="364,856.0469,354,860.0469,364,864.0469,360,860.0469" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="358" x2="919.5" y1="860.0469" y2="860.0469"/><polygon fill="#F05772" points="210,877.0469,200,881.0469,210,885.0469,206,881.0469" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="204" x2="347" y1="881.0469" y2="881.0469"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="199" x2="241" y1="918.3984" y2="918.3984"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="241" x2="241" y1="918.3984" y2="931.3984"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="200" x2="241" y1="931.3984" y2="931.3984"/><polygon fill="#F05772" points="210,927.3984,200,931.3984,210,935.3984,206,931.3984" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="206" y="913.542">Instantiate Component</text><polygon fill="#F05772" points="51,941.3984,41,945.3984,51,949.3984,47,945.3984" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="45" x2="188" y1="945.3984" y2="945.3984"/><!--MD5=[18537303d7694a657826eb8b4ba85843]
@startuml
hidefootbox
skinparam componentStyle uml2

skinparam defaultFontColor	#33335b

skinparam rectangle {
	color		#d6d6de
	backgroundColor	#ffffff
}

skinparam queue {
	color		#d6d6de
	backgroundColor	#ffffff
}

skinparam component {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}

skinparam interface {
	backgroundColor	#ffffff
	borderColor	#f05772
}

skinparam class {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}
skinparam stereotypeCBackgroundColor	#6fccdd

skinparam sequence {
	arrowColor		#4a4a86
	lifeLineBorderColor	#f05772
	groupBorderColor	#a1a1ca
	boxBorderColor		#a1a1ca
	dividerBorderColor	#d6d6de
	dividerBorderThickness	1
}
skinparam participant {
	borderColor		#33335b
	backgroundColor		#ffffff
}
skinparam actor {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam state {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam node {
	backgroundColor		#ffffff
}

skinparam note {
	backgroundColor 	#f6ed80
	borderColor		#d6d6de
}

skinparam activity {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam activityDiamond {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam arrowColor	#f05772
skinparam maxMessageSize 400
skinparam BoxPadding 4

box "Host" #LightGreen
	participant "Driver" as host_driver
end box

box "Media Processing Pipelines Layer" #LightSkyBlue
	participant "Component Manager" as component_manager
	participant "Library Manager" as lib_manager
	participant "MPP Memory Manager" as mpp_memory_manager
end box

box "Zephyr RTOS" #LightBlue
	participant "Memory Management Driver" as memory_management_driver
end box

box "Hardware" #LightGrey
	participant "Memory" as hw_memory
end box

host_driver -> lib_manager: Load Library
	activate lib_manager
	lib_manager -> mpp_memory_manager: rmalloc(MEM_ZONE_RUNTIME, flags=NULL, MEM_CAPS_LOADABLE_LIBRARY, size)
		activate mpp_memory_manager
		return address to store library
	lib_manager - -> host_driver
	deactivate lib_manager

host_driver -> lib_manager: Transfer library over DMA\nto given address

host_driver -> component_manager: Instantiate Component
	activate component_manager

	opt  if Component is Loadable and it is first instance
		component_manager -> lib_manager: Load component
		activate lib_manager

		loop repeat for Component TEXT, RODATA
			lib_manager -> lib_manager: read Component virtual address and size from manifest

			lib_manager -> memory_management_driver: sys_mm_drv_map_region(virt*, phys=NULL, size, flags=NULL)
				activate memory_management_driver
				memory_management_driver -> memory_management_driver: allocate free phys pages
				opt power up memory banks for allocated phys pages
					memory_management_driver -> hw_memory: power up memory banks
				end
				memory_management_driver - -> lib_manager
				deactivate memory_management_driver

			lib_manager -> lib_manager: read Component address offset from library manifest
			lib_manager -> lib_manager: mem_copy(virt*, library_store_addr + offset, size)
			lib_manager -> memory_management_driver: sys_mm_drv_update_region(virt*, size, flags= CODE / RODATA)
				activate memory_management_driver
				note right: update region flags to prevent overwrite
				return

		end

		opt if Component has BSS
			lib_manager -> memory_management_driver: sys_mm_drv_map_region(virt*, phys=NULL, bss_size, flags)
			activate memory_management_driver
			memory_management_driver -> memory_management_driver: allocate free phys pages
			opt power up memory banks for allocated phys pages
				memory_management_driver -> hw_memory: power up memory banks
			end
			memory_management_driver - -> lib_manager
			deactivate memory_management_driver
		end

		lib_manager - -> component_manager
		deactivate lib_manager
	end

	component_manager -> component_manager: Instantiate Component
	component_manager - -> host_driver

@enduml

PlantUML version 1.2019.12(Sun Nov 03 11:24:54 CET 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_302-b08
Operating System: Windows 10
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>