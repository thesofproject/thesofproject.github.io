<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="446px" preserveAspectRatio="none" style="width:650px;height:446px;" version="1.1" viewBox="0 0 650 446" width="650px" zoomAndPan="magnify"><defs><filter height="300%" id="f16w6c6n7dhk67" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" height="424.0547" style="stroke: #A1A1CA; stroke-width: 1.0;" width="66" x="31" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="34" x="47" y="16.0669">Host</text><rect fill="#DDDDDD" height="424.0547" style="stroke: #A1A1CA; stroke-width: 1.0;" width="154" x="203" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67" x="246.5" y="16.0669">HD/A HW</text><rect fill="#FFFFFF" height="424.0547" style="stroke: #A1A1CA; stroke-width: 1.0;" width="171" x="367" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="30" x="437.5" y="16.0669">DSP</text><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="64" x2="64" y1="74.7266" y2="434.0547"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="242" x2="242" y1="74.7266" y2="434.0547"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="320" x2="320" y1="74.7266" y2="434.0547"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="395" x2="395" y1="74.7266" y2="434.0547"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="493" x2="493" y1="74.7266" y2="434.0547"/><rect fill="#FFFFFF" filter="url(#f16w6c6n7dhk67)" height="46.5938" style="stroke: #33335B; stroke-width: 1.5;" width="54" x="35" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="46" y="43.1279">Host</text><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="42" y="59.4248">Driver</text><rect fill="#FFFFFF" filter="url(#f16w6c6n7dhk67)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="66" x="207" y="39.4297"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="214" y="59.4248">hda_sw</text><rect fill="#FFFFFF" filter="url(#f16w6c6n7dhk67)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="62" x="287" y="39.4297"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="294" y="59.4248">hda_fw</text><rect fill="#FFFFFF" filter="url(#f16w6c6n7dhk67)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="45" x="371" y="39.4297"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="378" y="59.4248">host</text><rect fill="#FFFFFF" filter="url(#f16w6c6n7dhk67)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="77" x="453" y="39.4297"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="460" y="59.4248">hda_dma</text><path d="M190,89.7266 L190,114.7266 L368,114.7266 L368,99.7266 L358,89.7266 L190,89.7266 " fill="#F6ED80" filter="url(#f16w6c6n7dhk67)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M358,89.7266 L358,99.7266 L368,99.7266 L358,89.7266 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="196" y="106.7935">"DMA in RUNNING state"</text><polygon fill="#F05772" points="52,140.9922,62,144.9922,52,148.9922,56,144.9922" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="3" x2="58" y1="144.9922" y2="144.9922"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="10" y="139.9263">Stop?</text><polygon fill="#F05772" points="383.5,175.125,393.5,179.125,383.5,183.125,387.5,179.125" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="64" x2="389.5" y1="179.125" y2="179.125"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="71" y="174.0591">COMP_TRIGGER_PAUSE ?</text><path d="M400,157.9922 L400,182.9922 L638,182.9922 L638,167.9922 L628,157.9922 L400,157.9922 " fill="#F6ED80" filter="url(#f16w6c6n7dhk67)" style="stroke: #D6D6DE; stroke-width: 1.0;"/><path d="M628,157.9922 L628,167.9922 L638,167.9922 L628,157.9922 " fill="#F6ED80" style="stroke: #D6D6DE; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="217" x="406" y="175.0591">No more FPI touching at this point</text><polygon fill="#F05772" points="75,194.125,65,198.125,75,202.125,71,198.125" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="69" x2="394.5" y1="198.125" y2="198.125"/><polygon fill="#F05772" points="230,223.2578,240,227.2578,230,231.2578,234,227.2578" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="64" x2="236" y1="227.2578" y2="227.2578"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="71" y="222.1919">RUN := 0</text><polygon fill="#F05772" points="383.5,252.3906,393.5,256.3906,383.5,260.3906,387.5,256.3906" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="64" x2="389.5" y1="256.3906" y2="256.3906"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="71" y="251.3247">COMP_TRIGGER_STOP</text><polygon fill="#F05772" points="481.5,281.5234,491.5,285.5234,481.5,289.5234,485.5,285.5234" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="395.5" x2="487.5" y1="285.5234" y2="285.5234"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="402.5" y="280.4575">dma_stop()</text><polygon fill="#F05772" points="331,310.6563,321,314.6563,331,318.6563,327,314.6563" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="325" x2="492.5" y1="314.6563" y2="314.6563"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="337" y="309.5903">GEN := 0</text><polygon fill="#F05772" points="331,339.7891,321,343.7891,331,347.7891,327,343.7891" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="325" x2="492.5" y1="343.7891" y2="343.7891"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="337" y="338.7231">FIFORDY := 0</text><polygon fill="#F05772" points="406.5,353.7891,396.5,357.7891,406.5,361.7891,402.5,357.7891" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="400.5" x2="492.5" y1="357.7891" y2="357.7891"/><polygon fill="#F05772" points="75,367.7891,65,371.7891,75,375.7891,71,371.7891" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="69" x2="394.5" y1="371.7891" y2="371.7891"/><polygon fill="#F05772" points="230,412.0547,240,416.0547,230,420.0547,234,416.0547" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="64" x2="236" y1="416.0547" y2="416.0547"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="71" y="395.856">Flush DMA,</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="71" y="410.9888">set SRST (stream reset)</text><!--MD5=[d84cf4cae5c14abbd2ee4bbd30052b6d]
@startuml
hidefootbox
skinparam componentStyle uml2

skinparam defaultFontColor	#33335b

skinparam rectangle {
	color		#d6d6de
	backgroundColor	#ffffff
}

skinparam component {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}

skinparam interface {
	backgroundColor	#ffffff
	borderColor	#f05772
}

skinparam class {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}
skinparam stereotypeCBackgroundColor	#6fccdd

skinparam sequence {
	arrowColor		#4a4a86
	lifeLineBorderColor	#f05772
	groupBorderColor	#a1a1ca
	boxBorderColor		#a1a1ca
	dividerBorderColor	#d6d6de
	dividerBorderThickness	1
}
skinparam participant {
	borderColor		#33335b
	backgroundColor		#ffffff
}
skinparam actor {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam state {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam node {
	backgroundColor		#ffffff
}

skinparam note {
	backgroundColor 	#f6ed80
	borderColor		#d6d6de
}

skinparam activity {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam activityDiamond {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam arrowColor	#f05772
skinparam maxMessageSize 400
skinparam BoxPadding 4
box "Host" #ffffff
    participant "Host\nDriver" as drv
end box
box "HD/A HW"
	participant hda_sw
	participant hda_fw
end box
box "DSP" #ffffff
    participant host
    participant hda_dma
end box

note over hda_sw, hda_fw: "DMA in RUNNING state"

-> drv : Stop?

    drv -> host : COMP_TRIGGER_PAUSE ?
            note right : No more FPI touching at this point
        drv <- - host

    drv -> hda_sw : RUN := 0

    drv -> host : COMP_TRIGGER_STOP
        host -> hda_dma : dma_stop()
            hda_fw <- hda_dma : GEN := 0
            hda_fw <- hda_dma : FIFORDY := 0
            host <- - hda_dma
        drv <- - host

    drv -> hda_sw : Flush DMA,\nset SRST (stream reset)

@enduml

PlantUML version 1.2019.12(Sun Nov 03 10:24:54 UTC 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.24+8
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>