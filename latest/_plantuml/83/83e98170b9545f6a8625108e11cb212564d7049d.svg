<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="645px" preserveAspectRatio="none" style="width:1110px;height:645px;" version="1.1" viewBox="0 0 1110 645" width="1110px" zoomAndPan="magnify"><defs><filter height="300%" id="f1wc2g98eg5fjo" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#90EE90" height="623.4922" style="stroke: #A1A1CA; stroke-width: 1.0;" width="66" x="8" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="34" x="24" y="16.0669">Host</text><rect fill="#87CEFA" height="623.4922" style="stroke: #A1A1CA; stroke-width: 1.0;" width="501" x="234" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="470" y="16.0669">SOF</text><rect fill="#ADD8E6" height="623.4922" style="stroke: #A1A1CA; stroke-width: 1.0;" width="220" x="873" y="4"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="935.5" y="16.0669">Zephyr RTOS</text><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="525.9297" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="286" y="89.5625"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="467.6641" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="431" y="118.6953"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="29.1328" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="663" y="187.0938"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="29.1328" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="663" y="260.1641"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="231.7969" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="663" y="325.4297"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="14" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="978" y="354.5625"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="14" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="978" y="397.6953"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="14" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="978" y="507.0938"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="163.6016" style="stroke: #A1A1CA; stroke-width: 2.0;" width="397" x="344" y="133.6953"/><rect fill="#FFFFFF" height="73.0703" style="stroke: none; stroke-width: 1.0;" width="397" x="344" y="224.2266"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="102.3984" style="stroke: #A1A1CA; stroke-width: 2.0;" width="504" x="595" y="426.6953"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="41" x2="41" y1="58.4297" y2="633.4922"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="291" x2="291" y1="58.4297" y2="633.4922"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="436" x2="436" y1="58.4297" y2="633.4922"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="668" x2="668" y1="58.4297" y2="633.4922"/><line style="stroke: #F05772; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="983" x2="983" y1="58.4297" y2="633.4922"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="54" x="12" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="19" y="43.1279">Driver</text><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="102" x="238" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="245" y="43.1279">IPC4 Handler</text><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="160" x="354" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="146" x="361" y="43.1279">Component Manager</text><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="122" x="605" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="612" y="43.1279">Library Manager</text><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="30.2969" style="stroke: #33335B; stroke-width: 1.5;" width="208" x="877" y="23.1328"/><text fill="#33335B" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="194" x="884" y="43.1279">Memory Management Driver</text><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="525.9297" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="286" y="89.5625"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="467.6641" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="431" y="118.6953"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="29.1328" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="663" y="187.0938"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="29.1328" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="663" y="260.1641"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="231.7969" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="663" y="325.4297"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="14" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="978" y="354.5625"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="14" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="978" y="397.6953"/><rect fill="#FFFFFF" filter="url(#f1wc2g98eg5fjo)" height="14" style="stroke: #F05772; stroke-width: 1.0;" width="10" x="978" y="507.0938"/><polygon fill="#F05772" points="274,85.5625,284,89.5625,274,93.5625,278,89.5625" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="41" x2="280" y1="89.5625" y2="89.5625"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="226" x="48" y="84.4966">SOF_IPC4_MOD_DELETE_INSTANCE</text><polygon fill="#F05772" points="419,114.6953,429,118.6953,419,122.6953,423,118.6953" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="296" x2="425" y1="118.6953" y2="118.6953"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="303" y="113.6294">Free comp_driver</text><path d="M344,133.6953 L408,133.6953 L408,140.6953 L398,150.6953 L344,150.6953 L344,133.6953 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="163.6016" style="stroke: #A1A1CA; stroke-width: 2.0;" width="397" x="344" y="133.6953"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="359" y="146.7622">alt</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="423" y="145.9058">[IADK module]</text><polygon fill="#F05772" points="651,183.0938,661,187.0938,651,191.0938,655,187.0938" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="441" x2="657" y1="187.0938" y2="187.0938"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="448" y="166.895">Deinitialize comp_driver</text><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="448" y="182.0278">with Processing Module Adapter</text><polygon fill="#F05772" points="452,212.2266,442,216.2266,452,220.2266,448,216.2266" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="446" x2="667" y1="216.2266" y2="216.2266"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="458" y="211.1606">return status</text><line style="stroke: #A1A1CA; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="344" x2="741" y1="225.2266" y2="225.2266"/><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="87" x="349" y="235.437">[SOF module]</text><polygon fill="#F05772" points="651,256.1641,661,260.1641,651,264.1641,655,260.1641" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="441" x2="657" y1="260.1641" y2="260.1641"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="448" y="255.0981">Deinitialize comp_driver</text><polygon fill="#F05772" points="452,285.2969,442,289.2969,452,293.2969,448,289.2969" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="446" x2="667" y1="289.2969" y2="289.2969"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="458" y="284.231">return status</text><polygon fill="#F05772" points="651,321.4297,661,325.4297,651,329.4297,655,325.4297" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="441" x2="657" y1="325.4297" y2="325.4297"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="448" y="320.3638">Free comp_driver resources</text><polygon fill="#F05772" points="966,350.5625,976,354.5625,966,358.5625,970,354.5625" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="673" x2="972" y1="354.5625" y2="354.5625"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="286" x="680" y="349.4966">Free/Unmap L2 memory for code and rodata</text><polygon fill="#F05772" points="684,364.5625,674,368.5625,684,372.5625,680,368.5625" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="678" x2="982" y1="368.5625" y2="368.5625"/><polygon fill="#F05772" points="966,393.6953,976,397.6953,966,401.6953,970,397.6953" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="673" x2="972" y1="397.6953" y2="397.6953"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="680" y="392.6294">Free/Unmap L2 memory for bss</text><polygon fill="#F05772" points="684,407.6953,674,411.6953,684,415.6953,680,411.6953" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="678" x2="982" y1="411.6953" y2="411.6953"/><path d="M595,426.6953 L672,426.6953 L672,433.6953 L662,443.6953 L595,443.6953 L595,426.6953 " fill="#EEEEEE" style="stroke: #A1A1CA; stroke-width: 1.0;"/><rect fill="none" height="102.3984" style="stroke: #A1A1CA; stroke-width: 2.0;" width="504" x="595" y="426.6953"/><text fill="#33335B" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="610" y="439.7622">loop</text><text fill="#33335B" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="220" x="687" y="438.9058">[Search library for shared module]</text><line style="stroke: #F05772; stroke-width: 1.0;" x1="673" x2="715" y1="464.9609" y2="464.9609"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="715" x2="715" y1="464.9609" y2="477.9609"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="674" x2="715" y1="477.9609" y2="477.9609"/><polygon fill="#F05772" points="684,473.9609,674,477.9609,684,481.9609,680,477.9609" style="stroke: #F05772; stroke-width: 1.0;"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="680" y="459.895">Check if shared module exists and is loaded</text><polygon fill="#F05772" points="966,503.0938,976,507.0938,966,511.0938,970,507.0938" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="673" x2="972" y1="507.0938" y2="507.0938"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="680" y="502.0278">Free/Unmap L2 memory for shared module</text><polygon fill="#F05772" points="684,517.0938,674,521.0938,684,525.0938,680,521.0938" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="678" x2="982" y1="521.0938" y2="521.0938"/><polygon fill="#F05772" points="452,553.2266,442,557.2266,452,561.2266,448,557.2266" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="446" x2="667" y1="557.2266" y2="557.2266"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="458" y="552.1606">return status</text><polygon fill="#F05772" points="307,582.3594,297,586.3594,307,590.3594,303,586.3594" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="301" x2="435" y1="586.3594" y2="586.3594"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="313" y="581.2935">return status</text><polygon fill="#F05772" points="52,611.4922,42,615.4922,52,619.4922,48,615.4922" style="stroke: #F05772; stroke-width: 1.0;"/><line style="stroke: #F05772; stroke-width: 1.0;" x1="46" x2="290" y1="615.4922" y2="615.4922"/><text fill="#33335B" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="58" y="610.4263">Complete IPC request</text><!--MD5=[0f66bc1105656c2955c23ec70fea3780]
@startuml
hidefootbox
skinparam componentStyle uml2

skinparam defaultFontColor	#33335b

skinparam rectangle {
	color		#d6d6de
	backgroundColor	#ffffff
}

skinparam component {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}

skinparam interface {
	backgroundColor	#ffffff
	borderColor	#f05772
}

skinparam class {
	backgroundColor	#ffffff
	borderColor	#33335b
	arrowColor	#f05772
}
skinparam stereotypeCBackgroundColor	#6fccdd

skinparam sequence {
	arrowColor		#4a4a86
	lifeLineBorderColor	#f05772
	groupBorderColor	#a1a1ca
	boxBorderColor		#a1a1ca
	dividerBorderColor	#d6d6de
	dividerBorderThickness	1
}
skinparam participant {
	borderColor		#33335b
	backgroundColor		#ffffff
}
skinparam actor {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam state {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam node {
	backgroundColor		#ffffff
}

skinparam note {
	backgroundColor 	#f6ed80
	borderColor		#d6d6de
}

skinparam activity {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam activityDiamond {
	borderColor		#33335b
	backgroundColor		#ffffff
}

skinparam arrowColor	#f05772
skinparam maxMessageSize 400
skinparam BoxPadding 4

box "Host" #LightGreen
	participant "Driver" as host_driver
end box

box "SOF" #LightSkyBlue
	participant "IPC4 Handler" as ipc4_handler
	participant "Component Manager" as component_manager
	participant "Library Manager" as library_manager
end box

box "Zephyr RTOS" #LightBlue
	participant "Memory Management Driver" as memory_management_driver
end box

host_driver -> ipc4_handler: SOF_IPC4_MOD_DELETE_INSTANCE
	activate ipc4_handler
	ipc4_handler -> component_manager: Free comp_driver
	activate component_manager
	alt IADK module
		component_manager -> library_manager: Deinitialize comp_driver \nwith Processing Module Adapter 
		activate library_manager
		library_manager -> component_manager: return status
		deactivate library_manager
	else SOF module
		component_manager -> library_manager: Deinitialize comp_driver 
		activate library_manager
		library_manager -> component_manager: return status
		deactivate library_manager
	end alt
	component_manager -> library_manager: Free comp_driver resources
	activate library_manager
	library_manager -> memory_management_driver: Free/Unmap L2 memory for code and rodata
	activate memory_management_driver
	memory_management_driver -> library_manager
	deactivate memory_management_driver
	library_manager -> memory_management_driver: Free/Unmap L2 memory for bss
	activate memory_management_driver
	memory_management_driver -> library_manager
	deactivate memory_management_driver
	loop Search library for shared module
		library_manager -> library_manager: Check if shared module exists and is loaded
		library_manager -> memory_management_driver: Free/Unmap L2 memory for shared module
		activate memory_management_driver
		memory_management_driver -> library_manager
		deactivate memory_management_driver
	end loop
	library_manager -> component_manager: return status
	deactivate library_manager
	component_manager -> ipc4_handler: return status
	deactivate component_manager
ipc4_handler -> host_driver: Complete IPC request
deactivate ipc4_handler

@enduml

PlantUML version 1.2019.12(Sun Nov 03 10:24:54 UTC 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.22+7
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>