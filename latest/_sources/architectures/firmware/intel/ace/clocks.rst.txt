.. _intel-ace-clocks:

Clocks
######

DSP wall clock sync
*******************

The primary firmware infrastructure is responsible for DSP Wall clock
synchronization with Hammock Harbor ART. The clock synchronization shall be
triggered periodically when DTF is enabled.

.. TODO: Add link to DSP_Wall_Clock_sync_to_Hammock_Harbor_ART

DSP and I/O Clock Source
************************

ACE PLL
=======

The ACE PLL is an optional internal PLL clock source for ACE. The PLL can be
configurable if such HW option was selected.

When ACE PLL is configured, it is replacing the following clock sources:

-  WoV CRO,
-  LP Ring Oscillator,
-  HP Ring Oscillator,

The ACE PLL reuses the WoV CRO programmable clock dividers, and supplies the ACE
internal clocks. The Clock Divider Select register like DSPCDS, IOCDS, WoVCDS,
AONCDS and CARCDS are tuned by FW based on clocking requirements.

Refer to [ACE-PLL HAS] for more details.

Clock Sources
=============

**NOTE:** Refer to HW configuration for a specific platform to check whether the
clock source is present.

There are following clocks available in ACE hardware that DSP and I/Os can run
from:

-  Resume clock,

   -  Supported frequency: 32.768 KHz,
   -  Mandatory - this clock source is present in all SOCs,

-  HP RING Oscillator clock,

   -  Supported frequency: 76.8 MHz to 800 MHz,
   -  Optional - it depends on parameter CLKHPROSCE hardware parameter),
   -  sourced from ACE-PLL in MTL and the frequency is controlled via FW
      programmable dividers,

-  LP RING Oscillator clock,

   -  Supported frequency: 19.2 MHz to 120 MHz,
   -  Mandatory - this clock source is present in all SOCs,
   -  sourced from ACE-PLL in MTL and the frequency is controlled via FW
      programmable dividers,

-  WoV RING Oscillator Clock,

   -  Supported frequency: 19.2 MHz/ 24.576 MHz / 38.4 MHz (hard strap
      selectable),
   -  Optional - it depends on parameter CLKWOVROSCE hardware parameter,
   -  sourced from ACE-PLL in MTL,

-  XTAL Oscillator Clock,

   -  Supported frequency: 19.2 MHz / 24.576 Mhz / 38.4 MHz (hard strap
      selectable),
   -  Mandatory - this clock source is present in all SOCs,
   -  design time decision whether it is a separate clock source or
      sourced from ACE-PLL,
   -  sourced from ACE-PLL in MTL,

.. TODO: Add table with Platform Available Clock Sources from SIP_ACE.x_FAS.xlsx

**NOTE:** Using WoV CRO may be required to meet KPIs for WoV.

Changing DSP Clock Frequency
****************************

ACE HW allows to change the clock frequency by firmware. It can be done by
programming the CLKCTL.EOCS and CLKCTL.OCS register fields with the intended new
frequency. HW will change the clocking to the new clock frequency, while the DSP
domain may or may not be idle.
