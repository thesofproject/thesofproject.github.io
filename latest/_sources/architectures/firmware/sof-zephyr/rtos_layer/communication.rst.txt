.. _sof-zephyr-rtos-communication:

Communication
#############

There are two types of communication mechanisms, Inter Processor Communication
(IPC) and Inter DSP Communication (IDC).

IPC is used by the FW to communicate with another processor/controller located
outside the audio DSP subsystem. IDC is used to communicate with another DSP
cores located in the audio DSP subsystem.

IPC and IDC communication assumes that messages may include quite large payload
exchanged via mailboxes. Depending on capabilities of the IPC and the IDC
hardware available on the platform, mailboxes may require another HW mechanism
to share a memory buffer or exchange the message payload in other way between
the processors.

IPC
***

IPC works in synchronous way in the DSP FW. Communication is always started by a
command (also known as request) sent by one processor to another. This may be an
incoming command initiated by another processor or an outgoing command initiated
by the DSP core. Once the command is handled, a response is sent back. The
initiator must wait with sending another IPC request until after response on the
previous one is received.

There are also unsolicited notification sent by the DSP FW to other processors
in order to report events that happened in the DSP.

Incoming IPC commands may target either the FW infrastructure or pipeline
components.

Component Instance Addressing
=============================

Each component type has its own unique ID assigned by the firmware
infrastructure.

.. TODO: Add link to component ID assignment description

Each component can have multiple instances. The maximum amount of instances is
defined per component type and it is part of a component configuration. The
instance IDs are assigned by SW during component creation.

Examples:

-  Audio components (Copier, Mixers, KPB, etc.) - each audio component has its
   own unique component ID

Flows
=====

Incoming IPC request
--------------------

The below diagram depicts how IPC requests are handled within primary and
secondary DSP cores.

.. uml:: images/ipc_host_communication.pu
   :caption: Host initiated IPC communication

Outgoing IPC notification
-------------------------

.. uml:: images/ipc_dsp_notification.pu
   :caption: DSP IPC notification
